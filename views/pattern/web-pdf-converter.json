{"path": "/home/asumal/git/cs410/pattern/pattern/web/pdf/converter.py", "lines": [{"index": "1", "colour": "orange", "code": "#!/usr/bin/env python2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "2", "colour": "orange", "code": "import sys, os.path\n", "error": "none", "author": "tom@organisms.be"}, {"index": "3", "colour": "green", "code": "from pdfdevice import PDFDevice, PDFTextDevice\n", "error": "W", "author": "tom@organisms.be"}, {"index": "4", "colour": "green", "code": "from pdffont import PDFUnicodeNotDefined\n", "error": "W", "author": "tom@organisms.be"}, {"index": "5", "colour": "green", "code": "from pdftypes import LITERALS_DCT_DECODE\n", "error": "W", "author": "tom@organisms.be"}, {"index": "6", "colour": "green", "code": "from pdfcolor import LITERAL_DEVICE_GRAY, LITERAL_DEVICE_RGB\n", "error": "W", "author": "tom@organisms.be"}, {"index": "7", "colour": "green", "code": "from layout import LTContainer, LTPage, LTText, LTLine, LTRect, LTCurve\n", "error": "W", "author": "tom@organisms.be"}, {"index": "8", "colour": "green", "code": "from layout import LTFigure, LTImage, LTChar, LTTextLine\n", "error": "W", "author": "tom@organisms.be"}, {"index": "9", "colour": "green", "code": "from layout import LTTextBox, LTTextBoxVertical, LTTextGroup\n", "error": "W", "author": "tom@organisms.be"}, {"index": "10", "colour": "green", "code": "from utils import apply_matrix_pt, mult_matrix\n", "error": "W", "author": "tom@organisms.be"}, {"index": "11", "colour": "green", "code": "from utils import enc, bbox2str, create_bmp\n", "error": "W", "author": "tom@organisms.be"}, {"index": "12", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "13", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "14", "colour": "orange", "code": "##  PDFLayoutAnalyzer\n", "error": "none", "author": "tom@organisms.be"}, {"index": "15", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "16", "colour": "orange", "code": "class PDFLayoutAnalyzer(PDFTextDevice):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "17", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "18", "colour": "orange", "code": "    def __init__(self, rsrcmgr, pageno=1, laparams=None):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "19", "colour": "orange", "code": "        PDFTextDevice.__init__(self, rsrcmgr)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "20", "colour": "orange", "code": "        self.pageno = pageno\n", "error": "none", "author": "tom@organisms.be"}, {"index": "21", "colour": "orange", "code": "        self.laparams = laparams\n", "error": "none", "author": "tom@organisms.be"}, {"index": "22", "colour": "orange", "code": "        self._stack = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "23", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "24", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "25", "colour": "orange", "code": "    def begin_page(self, page, ctm):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "26", "colour": "orange", "code": "        (x0,y0,x1,y1) = page.mediabox\n", "error": "none", "author": "tom@organisms.be"}, {"index": "27", "colour": "orange", "code": "        (x0,y0) = apply_matrix_pt(ctm, (x0,y0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "28", "colour": "orange", "code": "        (x1,y1) = apply_matrix_pt(ctm, (x1,y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "29", "colour": "orange", "code": "        mediabox = (0, 0, abs(x0-x1), abs(y0-y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "30", "colour": "green", "code": "        self.cur_item = LTPage(self.pageno, mediabox)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "31", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "32", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "33", "colour": "orange", "code": "    def end_page(self, page):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "34", "colour": "orange", "code": "        assert not self._stack\n", "error": "none", "author": "tom@organisms.be"}, {"index": "35", "colour": "orange", "code": "        assert isinstance(self.cur_item, LTPage)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "36", "colour": "orange", "code": "        if self.laparams is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "37", "colour": "orange", "code": "            self.cur_item.analyze(self.laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "38", "colour": "orange", "code": "        self.pageno += 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "39", "colour": "orange", "code": "        self.receive_layout(self.cur_item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "40", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "41", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "42", "colour": "orange", "code": "    def begin_figure(self, name, bbox, matrix):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "43", "colour": "orange", "code": "        self._stack.append(self.cur_item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "44", "colour": "green", "code": "        self.cur_item = LTFigure(name, bbox, mult_matrix(matrix, self.ctm))\n", "error": "W", "author": "tom@organisms.be"}, {"index": "45", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "46", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "47", "colour": "orange", "code": "    def end_figure(self, _):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "48", "colour": "orange", "code": "        fig = self.cur_item\n", "error": "none", "author": "tom@organisms.be"}, {"index": "49", "colour": "orange", "code": "        assert isinstance(self.cur_item, LTFigure)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "50", "colour": "green", "code": "        self.cur_item = self._stack.pop()\n", "error": "W", "author": "tom@organisms.be"}, {"index": "51", "colour": "orange", "code": "        self.cur_item.add(fig)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "52", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "53", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "54", "colour": "orange", "code": "    def render_image(self, name, stream):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "55", "colour": "orange", "code": "        assert isinstance(self.cur_item, LTFigure)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "56", "colour": "orange", "code": "        item = LTImage(name, stream,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "57", "colour": "orange", "code": "                       (self.cur_item.x0, self.cur_item.y0,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "58", "colour": "orange", "code": "                        self.cur_item.x1, self.cur_item.y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "59", "colour": "orange", "code": "        self.cur_item.add(item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "60", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "61", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "62", "colour": "blue", "code": "    def paint_path(self, gstate, stroke, fill, evenodd, path):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "63", "colour": "orange", "code": "        shape = ''.join(x[0] for x in path)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "64", "colour": "orange", "code": "        if shape == 'ml':\n", "error": "none", "author": "tom@organisms.be"}, {"index": "65", "colour": "orange", "code": "            # horizontal/vertical line\n", "error": "none", "author": "tom@organisms.be"}, {"index": "66", "colour": "orange", "code": "            (_,x0,y0) = path[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "67", "colour": "orange", "code": "            (_,x1,y1) = path[1]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "68", "colour": "orange", "code": "            (x0,y0) = apply_matrix_pt(self.ctm, (x0,y0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "69", "colour": "orange", "code": "            (x1,y1) = apply_matrix_pt(self.ctm, (x1,y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "70", "colour": "orange", "code": "            if x0 == x1 or y0 == y1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "71", "colour": "orange", "code": "                self.cur_item.add(LTLine(gstate.linewidth, (x0,y0), (x1,y1)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "72", "colour": "orange", "code": "                return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "73", "colour": "orange", "code": "        if shape == 'mlllh':\n", "error": "none", "author": "tom@organisms.be"}, {"index": "74", "colour": "orange", "code": "            # rectangle\n", "error": "none", "author": "tom@organisms.be"}, {"index": "75", "colour": "orange", "code": "            (_,x0,y0) = path[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "76", "colour": "orange", "code": "            (_,x1,y1) = path[1]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "77", "colour": "orange", "code": "            (_,x2,y2) = path[2]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "78", "colour": "orange", "code": "            (_,x3,y3) = path[3]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "79", "colour": "orange", "code": "            (x0,y0) = apply_matrix_pt(self.ctm, (x0,y0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "80", "colour": "orange", "code": "            (x1,y1) = apply_matrix_pt(self.ctm, (x1,y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "81", "colour": "orange", "code": "            (x2,y2) = apply_matrix_pt(self.ctm, (x2,y2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "82", "colour": "orange", "code": "            (x3,y3) = apply_matrix_pt(self.ctm, (x3,y3))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "83", "colour": "orange", "code": "            if ((x0 == x1 and y1 == y2 and x2 == x3 and y3 == y0) or\n", "error": "none", "author": "tom@organisms.be"}, {"index": "84", "colour": "orange", "code": "                (y0 == y1 and x1 == x2 and y2 == y3 and x3 == x0)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "85", "colour": "orange", "code": "                self.cur_item.add(LTRect(gstate.linewidth, (x0,y0,x2,y2)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "86", "colour": "orange", "code": "                return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "87", "colour": "orange", "code": "        # other shapes\n", "error": "none", "author": "tom@organisms.be"}, {"index": "88", "colour": "orange", "code": "        pts = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "89", "colour": "orange", "code": "        for p in path:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "90", "colour": "orange", "code": "            for i in xrange(1, len(p), 2):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "91", "colour": "orange", "code": "                pts.append(apply_matrix_pt(self.ctm, (p[i], p[i+1])))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "92", "colour": "orange", "code": "        self.cur_item.add(LTCurve(gstate.linewidth, pts))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "93", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "94", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "95", "colour": "blue", "code": "    def render_char(self, matrix, font, fontsize, scaling, rise, cid):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "96", "colour": "orange", "code": "        try:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "97", "colour": "orange", "code": "            text = font.to_unichr(cid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "98", "colour": "orange", "code": "            assert isinstance(text, unicode), text\n", "error": "none", "author": "tom@organisms.be"}, {"index": "99", "colour": "orange", "code": "        except PDFUnicodeNotDefined:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "100", "colour": "orange", "code": "            text = self.handle_undefined_char(font, cid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "101", "colour": "orange", "code": "        textwidth = font.char_width(cid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "102", "colour": "orange", "code": "        textdisp = font.char_disp(cid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "103", "colour": "orange", "code": "        item = LTChar(matrix, font, fontsize, scaling, rise, text, textwidth, textdisp)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "104", "colour": "orange", "code": "        self.cur_item.add(item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "105", "colour": "orange", "code": "        return item.adv\n", "error": "none", "author": "tom@organisms.be"}, {"index": "106", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "107", "colour": "orange", "code": "    def handle_undefined_char(self, font, cid):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "108", "colour": "orange", "code": "        if self.debug:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "109", "colour": "orange", "code": "            print >>sys.stderr, 'undefined: %r, %r' % (font, cid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "110", "colour": "orange", "code": "        return '(cid:%d)' % cid\n", "error": "none", "author": "tom@organisms.be"}, {"index": "111", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "112", "colour": "blue", "code": "    def receive_layout(self, ltpage):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "113", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "114", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "115", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "116", "colour": "orange", "code": "##  PDFPageAggregator\n", "error": "none", "author": "tom@organisms.be"}, {"index": "117", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "118", "colour": "orange", "code": "class PDFPageAggregator(PDFLayoutAnalyzer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "119", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "120", "colour": "orange", "code": "    def __init__(self, rsrcmgr, pageno=1, laparams=None):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "121", "colour": "orange", "code": "        PDFLayoutAnalyzer.__init__(self, rsrcmgr, pageno=pageno, laparams=laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "122", "colour": "orange", "code": "        self.result = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "123", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "124", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "125", "colour": "orange", "code": "    def receive_layout(self, ltpage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "126", "colour": "orange", "code": "        self.result = ltpage\n", "error": "none", "author": "tom@organisms.be"}, {"index": "127", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "128", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "129", "colour": "orange", "code": "    def get_result(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "130", "colour": "orange", "code": "        return self.result\n", "error": "none", "author": "tom@organisms.be"}, {"index": "131", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "132", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "133", "colour": "orange", "code": "##  PDFConverter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "134", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "135", "colour": "orange", "code": "class PDFConverter(PDFLayoutAnalyzer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "136", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "137", "colour": "blue", "code": "    def __init__(self, rsrcmgr, outfp, codec='utf-8', pageno=1, laparams=None):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "138", "colour": "orange", "code": "        PDFLayoutAnalyzer.__init__(self, rsrcmgr, pageno=pageno, laparams=laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "139", "colour": "orange", "code": "        self.outfp = outfp\n", "error": "none", "author": "tom@organisms.be"}, {"index": "140", "colour": "orange", "code": "        self.codec = codec\n", "error": "none", "author": "tom@organisms.be"}, {"index": "141", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "142", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "143", "colour": "orange", "code": "    def write_image(self, image):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "144", "colour": "orange", "code": "        stream = image.stream\n", "error": "none", "author": "tom@organisms.be"}, {"index": "145", "colour": "orange", "code": "        filters = stream.get_filters()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "146", "colour": "orange", "code": "        if len(filters) == 1 and filters[0] in LITERALS_DCT_DECODE:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "147", "colour": "orange", "code": "            ext = '.jpg'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "148", "colour": "orange", "code": "            data = stream.get_rawdata()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "149", "colour": "orange", "code": "        elif stream.colorspace is LITERAL_DEVICE_RGB:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "150", "colour": "orange", "code": "            ext = '.bmp'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "151", "colour": "orange", "code": "            data = create_bmp(stream.get_data(), stream.bits*3, image.width, image.height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "152", "colour": "orange", "code": "        elif stream.colorspace is LITERAL_DEVICE_GRAY:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "153", "colour": "orange", "code": "            ext = '.bmp'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "154", "colour": "orange", "code": "            data = create_bmp(stream.get_data(), stream.bits, image.width, image.height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "155", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "156", "colour": "orange", "code": "            ext = '.img'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "157", "colour": "orange", "code": "            data = stream.get_data()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "158", "colour": "orange", "code": "        name = image.name+ext\n", "error": "none", "author": "tom@organisms.be"}, {"index": "159", "colour": "red", "code": "        path = os.path.join(self.outdir, name)\n", "error": "E", "author": "tom@organisms.be"}, {"index": "160", "colour": "green", "code": "        fp = file(path, 'wb')\n", "error": "W", "author": "tom@organisms.be"}, {"index": "161", "colour": "orange", "code": "        fp.write(data)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "162", "colour": "orange", "code": "        fp.close()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "163", "colour": "orange", "code": "        return name\n", "error": "none", "author": "tom@organisms.be"}, {"index": "164", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "165", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "166", "colour": "orange", "code": "##  TextConverter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "167", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "168", "colour": "orange", "code": "class TextConverter(PDFConverter):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "169", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "170", "colour": "blue", "code": "    def __init__(self, rsrcmgr, outfp, codec='utf-8', pageno=1, laparams=None,\n", "error": "R", "author": "tom@organisms.be"}, {"index": "171", "colour": "orange", "code": "                 showpageno=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "172", "colour": "orange", "code": "        PDFConverter.__init__(self, rsrcmgr, outfp, codec=codec, pageno=pageno, laparams=laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "173", "colour": "orange", "code": "        self.showpageno = showpageno\n", "error": "none", "author": "tom@organisms.be"}, {"index": "174", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "175", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "176", "colour": "orange", "code": "    def write_text(self, text):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "177", "colour": "orange", "code": "        self.outfp.write(text.encode(self.codec, 'ignore'))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "178", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "179", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "180", "colour": "orange", "code": "    def receive_layout(self, ltpage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "181", "colour": "orange", "code": "        def render(item):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "182", "colour": "orange", "code": "            if isinstance(item, LTContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "183", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "184", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "185", "colour": "orange", "code": "            elif isinstance(item, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "186", "colour": "orange", "code": "                self.write_text(item.get_text())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "187", "colour": "orange", "code": "            if isinstance(item, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "188", "colour": "orange", "code": "                self.write_text('\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "189", "colour": "orange", "code": "        if self.showpageno:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "190", "colour": "orange", "code": "            self.write_text('Page %s\\n' % ltpage.pageid)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "191", "colour": "orange", "code": "        render(ltpage)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "192", "colour": "orange", "code": "        self.write_text('\\f')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "193", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "194", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "195", "colour": "orange", "code": "    # Some dummy functions to save memory/CPU when all that is wanted is text.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "196", "colour": "orange", "code": "    # This stops all the image and drawing ouput from being recorded and taking\n", "error": "none", "author": "tom@organisms.be"}, {"index": "197", "colour": "orange", "code": "    # up RAM.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "198", "colour": "orange", "code": "    def render_image(self, name, stream):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "199", "colour": "orange", "code": "        pass\n", "error": "none", "author": "tom@organisms.be"}, {"index": "200", "colour": "blue", "code": "    def paint_path(self, gstate, stroke, fill, evenodd, path):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "201", "colour": "orange", "code": "        pass\n", "error": "none", "author": "tom@organisms.be"}, {"index": "202", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "203", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "204", "colour": "orange", "code": "##  HTMLConverter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "205", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "206", "colour": "blue", "code": "class HTMLConverter(PDFConverter):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "207", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "208", "colour": "orange", "code": "    RECT_COLORS = {\n", "error": "none", "author": "tom@organisms.be"}, {"index": "209", "colour": "orange", "code": "        #'char': 'green',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "210", "colour": "orange", "code": "        'figure': 'yellow',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "211", "colour": "orange", "code": "        'textline': 'magenta',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "212", "colour": "orange", "code": "        'textbox': 'cyan',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "213", "colour": "orange", "code": "        'textgroup': 'red',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "214", "colour": "orange", "code": "        'curve': 'black',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "215", "colour": "orange", "code": "        'page': 'gray',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "216", "colour": "orange", "code": "        }\n", "error": "none", "author": "tom@organisms.be"}, {"index": "217", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "218", "colour": "orange", "code": "    TEXT_COLORS = {\n", "error": "none", "author": "tom@organisms.be"}, {"index": "219", "colour": "orange", "code": "        'textbox': 'blue',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "220", "colour": "orange", "code": "        'char': 'black',\n", "error": "none", "author": "tom@organisms.be"}, {"index": "221", "colour": "orange", "code": "        }\n", "error": "none", "author": "tom@organisms.be"}, {"index": "222", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "223", "colour": "blue", "code": "    def __init__(self, rsrcmgr, outfp, codec='utf-8', pageno=1, laparams=None, \n", "error": "R", "author": "tom@organisms.be"}, {"index": "224", "colour": "orange", "code": "                 scale=1, fontscale=0.7, layoutmode='normal', showpageno=True,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "225", "colour": "orange", "code": "                 pagemargin=50, outdir=None,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "226", "colour": "orange", "code": "                 rect_colors={'curve':'black', 'page':'gray'},\n", "error": "none", "author": "tom@organisms.be"}, {"index": "227", "colour": "orange", "code": "                 text_colors={'char':'black'}):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "228", "colour": "orange", "code": "        PDFConverter.__init__(self, rsrcmgr, outfp, codec=codec, pageno=pageno, laparams=laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "229", "colour": "orange", "code": "        self.scale = scale\n", "error": "none", "author": "tom@organisms.be"}, {"index": "230", "colour": "orange", "code": "        self.fontscale = fontscale\n", "error": "none", "author": "tom@organisms.be"}, {"index": "231", "colour": "orange", "code": "        self.layoutmode = layoutmode\n", "error": "none", "author": "tom@organisms.be"}, {"index": "232", "colour": "orange", "code": "        self.showpageno = showpageno\n", "error": "none", "author": "tom@organisms.be"}, {"index": "233", "colour": "orange", "code": "        self.pagemargin = pagemargin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "234", "colour": "orange", "code": "        self.outdir = outdir\n", "error": "none", "author": "tom@organisms.be"}, {"index": "235", "colour": "orange", "code": "        self.rect_colors = rect_colors\n", "error": "none", "author": "tom@organisms.be"}, {"index": "236", "colour": "orange", "code": "        self.text_colors = text_colors\n", "error": "none", "author": "tom@organisms.be"}, {"index": "237", "colour": "orange", "code": "        if self.debug:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "238", "colour": "orange", "code": "            self.rect_colors.update(self.RECT_COLORS)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "239", "colour": "orange", "code": "            self.text_colors.update(self.TEXT_COLORS)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "240", "colour": "orange", "code": "        self._yoffset = self.pagemargin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "241", "colour": "orange", "code": "        self._font = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "242", "colour": "orange", "code": "        self._fontstack = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "243", "colour": "orange", "code": "        self.write_header()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "244", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "245", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "246", "colour": "orange", "code": "    def write(self, text):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "247", "colour": "orange", "code": "        self.outfp.write(text)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "248", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "249", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "250", "colour": "orange", "code": "    def write_header(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "251", "colour": "orange", "code": "        self.write('<html><head>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "252", "colour": "orange", "code": "        self.write('<meta http-equiv=\"Content-Type\" content=\"text/html; charset=%s\">\\n' % self.codec)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "253", "colour": "orange", "code": "        self.write('</head><body>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "254", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "255", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "256", "colour": "orange", "code": "    def write_footer(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "257", "colour": "orange", "code": "        self.write('<div style=\"position:absolute; top:0px;\">Page: %s</div>\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "258", "colour": "orange", "code": "                   ', '.join('<a href=\"#%s\">%s</a>' % (i,i) for i in xrange(1,self.pageno)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "259", "colour": "orange", "code": "        self.write('</body></html>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "260", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "261", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "262", "colour": "orange", "code": "    def write_text(self, text):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "263", "colour": "orange", "code": "        self.write(enc(text, self.codec))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "264", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "265", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "266", "colour": "blue", "code": "    def place_rect(self, color, borderwidth, x, y, w, h):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "267", "colour": "orange", "code": "        color = self.rect_colors.get(color)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "268", "colour": "orange", "code": "        if color is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "269", "colour": "orange", "code": "            self.write('<span style=\"position:absolute; border: %s %dpx solid; '\n", "error": "none", "author": "tom@organisms.be"}, {"index": "270", "colour": "orange", "code": "                       'left:%dpx; top:%dpx; width:%dpx; height:%dpx;\"></span>\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "271", "colour": "orange", "code": "                       (color, borderwidth,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "272", "colour": "orange", "code": "                        x*self.scale, (self._yoffset-y)*self.scale,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "273", "colour": "orange", "code": "                        w*self.scale, h*self.scale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "274", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "275", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "276", "colour": "orange", "code": "    def place_border(self, color, borderwidth, item):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "277", "colour": "orange", "code": "        self.place_rect(color, borderwidth, item.x0, item.y1, item.width, item.height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "278", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "279", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "280", "colour": "blue", "code": "    def place_image(self, item, borderwidth, x, y, w, h):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "281", "colour": "orange", "code": "        if self.outdir is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "282", "colour": "orange", "code": "            name = self.write_image(item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "283", "colour": "orange", "code": "            self.write('<img src=\"%s\" border=\"%d\" style=\"position:absolute; left:%dpx; top:%dpx;\" '\n", "error": "none", "author": "tom@organisms.be"}, {"index": "284", "colour": "orange", "code": "                       'width=\"%d\" height=\"%d\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "285", "colour": "orange", "code": "                       (enc(name), borderwidth,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "286", "colour": "orange", "code": "                        x*self.scale, (self._yoffset-y)*self.scale,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "287", "colour": "orange", "code": "                        w*self.scale, h*self.scale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "288", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "289", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "290", "colour": "blue", "code": "    def place_text(self, color, text, x, y, size):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "291", "colour": "orange", "code": "        color = self.text_colors.get(color)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "292", "colour": "orange", "code": "        if color is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "293", "colour": "orange", "code": "            self.write('<span style=\"position:absolute; color:%s; left:%dpx; top:%dpx; font-size:%dpx;\">' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "294", "colour": "orange", "code": "                       (color, x*self.scale, (self._yoffset-y)*self.scale, size*self.scale*self.fontscale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "295", "colour": "orange", "code": "            self.write_text(text)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "296", "colour": "orange", "code": "            self.write('</span>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "297", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "298", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "299", "colour": "blue", "code": "    def begin_textbox(self, color, borderwidth, x, y, w, h, writing_mode):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "300", "colour": "orange", "code": "        self._fontstack.append(self._font)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "301", "colour": "orange", "code": "        self._font = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "302", "colour": "orange", "code": "        self.write('<div style=\"position:absolute; border: %s %dpx solid; writing-mode:%s; '\n", "error": "none", "author": "tom@organisms.be"}, {"index": "303", "colour": "orange", "code": "                   'left:%dpx; top:%dpx; width:%dpx; height:%dpx;\">' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "304", "colour": "orange", "code": "                   (color, borderwidth, writing_mode,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "305", "colour": "orange", "code": "                    x*self.scale, (self._yoffset-y)*self.scale,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "306", "colour": "orange", "code": "                    w*self.scale, h*self.scale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "307", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "308", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "309", "colour": "orange", "code": "    def put_text(self, text, fontname, fontsize):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "310", "colour": "orange", "code": "        font = (fontname, fontsize)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "311", "colour": "orange", "code": "        if font != self._font:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "312", "colour": "orange", "code": "            if self._font is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "313", "colour": "orange", "code": "                self.write('</span>')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "314", "colour": "orange", "code": "            self.write('<span style=\"font-family: %s; font-size:%dpx\">' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "315", "colour": "orange", "code": "                       (fontname, fontsize * self.scale * self.fontscale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "316", "colour": "orange", "code": "            self._font = font\n", "error": "none", "author": "tom@organisms.be"}, {"index": "317", "colour": "orange", "code": "        self.write_text(text)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "318", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "319", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "320", "colour": "orange", "code": "    def put_newline(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "321", "colour": "orange", "code": "        self.write('<br>')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "322", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "323", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "324", "colour": "green", "code": "    def end_textbox(self, color):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "325", "colour": "orange", "code": "        if self._font is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "326", "colour": "orange", "code": "            self.write('</span>')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "327", "colour": "orange", "code": "        self._font = self._fontstack.pop()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "328", "colour": "orange", "code": "        self.write('</div>')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "329", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "330", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "331", "colour": "blue", "code": "    def receive_layout(self, ltpage):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "332", "colour": "orange", "code": "        def show_group(item):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "333", "colour": "orange", "code": "            if isinstance(item, LTTextGroup):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "334", "colour": "orange", "code": "                self.place_border('textgroup', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "335", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "336", "colour": "orange", "code": "                    show_group(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "337", "colour": "orange", "code": "            return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "338", "colour": "blue", "code": "        def render(item):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "339", "colour": "orange", "code": "            if isinstance(item, LTPage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "340", "colour": "orange", "code": "                self._yoffset += item.y1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "341", "colour": "orange", "code": "                self.place_border('page', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "342", "colour": "orange", "code": "                if self.showpageno:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "343", "colour": "orange", "code": "                    self.write('<div style=\"position:absolute; top:%dpx;\">' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "344", "colour": "orange", "code": "                               ((self._yoffset-item.y1)*self.scale))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "345", "colour": "orange", "code": "                    self.write('<a name=\"%s\">Page %s</a></div>\\n' % (item.pageid, item.pageid))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "346", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "347", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "348", "colour": "orange", "code": "                if item.groups is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "349", "colour": "orange", "code": "                    for group in item.groups:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "350", "colour": "orange", "code": "                        show_group(group)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "351", "colour": "orange", "code": "            elif isinstance(item, LTCurve):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "352", "colour": "orange", "code": "                self.place_border('curve', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "353", "colour": "orange", "code": "            elif isinstance(item, LTFigure):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "354", "colour": "orange", "code": "                self.place_border('figure', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "355", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "356", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "357", "colour": "orange", "code": "            elif isinstance(item, LTImage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "358", "colour": "orange", "code": "                self.place_image(item, 1, item.x0, item.y1, item.width, item.height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "359", "colour": "orange", "code": "            else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "360", "colour": "orange", "code": "                if self.layoutmode == 'exact':\n", "error": "none", "author": "tom@organisms.be"}, {"index": "361", "colour": "orange", "code": "                    if isinstance(item, LTTextLine):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "362", "colour": "orange", "code": "                        self.place_border('textline', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "363", "colour": "orange", "code": "                        for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "364", "colour": "orange", "code": "                            render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "365", "colour": "orange", "code": "                    elif isinstance(item, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "366", "colour": "orange", "code": "                        self.place_border('textbox', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "367", "colour": "orange", "code": "                        self.place_text('textbox', str(item.index+1), item.x0, item.y1, 20)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "368", "colour": "orange", "code": "                        for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "369", "colour": "orange", "code": "                            render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "370", "colour": "orange", "code": "                    elif isinstance(item, LTChar):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "371", "colour": "orange", "code": "                        self.place_border('char', 1, item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "372", "colour": "orange", "code": "                        self.place_text('char', item.get_text(), item.x0, item.y1, item.size)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "373", "colour": "orange", "code": "                else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "374", "colour": "orange", "code": "                    if isinstance(item, LTTextLine):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "375", "colour": "orange", "code": "                        for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "376", "colour": "orange", "code": "                            render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "377", "colour": "orange", "code": "                        if self.layoutmode != 'loose':\n", "error": "none", "author": "tom@organisms.be"}, {"index": "378", "colour": "orange", "code": "                            self.put_newline()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "379", "colour": "orange", "code": "                    elif isinstance(item, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "380", "colour": "orange", "code": "                        self.begin_textbox('textbox', 1, item.x0, item.y1, item.width, item.height,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "381", "colour": "orange", "code": "                                           item.get_writing_mode())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "382", "colour": "orange", "code": "                        for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "383", "colour": "orange", "code": "                            render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "384", "colour": "orange", "code": "                        self.end_textbox('textbox')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "385", "colour": "orange", "code": "                    elif isinstance(item, LTChar):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "386", "colour": "orange", "code": "                        self.put_text(item.get_text(), item.fontname, item.size)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "387", "colour": "orange", "code": "                    elif isinstance(item, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "388", "colour": "orange", "code": "                        self.write_text(item.get_text())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "389", "colour": "orange", "code": "            return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "390", "colour": "orange", "code": "        render(ltpage)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "391", "colour": "orange", "code": "        self._yoffset += self.pagemargin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "392", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "393", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "394", "colour": "orange", "code": "    def close(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "395", "colour": "orange", "code": "        self.write_footer()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "396", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "397", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "398", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "399", "colour": "orange", "code": "##  XMLConverter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "400", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "401", "colour": "blue", "code": "class XMLConverter(PDFConverter):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "402", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "403", "colour": "blue", "code": "    def __init__(self, rsrcmgr, outfp, codec='utf-8', pageno=1, laparams=None, outdir=None):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "404", "colour": "orange", "code": "        PDFConverter.__init__(self, rsrcmgr, outfp, codec=codec, pageno=pageno, laparams=laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "405", "colour": "orange", "code": "        self.outdir = outdir\n", "error": "none", "author": "tom@organisms.be"}, {"index": "406", "colour": "orange", "code": "        self.write_header()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "407", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "408", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "409", "colour": "orange", "code": "    def write_header(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "410", "colour": "orange", "code": "        self.outfp.write('<?xml version=\"1.0\" encoding=\"%s\" ?>\\n' % self.codec)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "411", "colour": "orange", "code": "        self.outfp.write('<pages>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "412", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "413", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "414", "colour": "orange", "code": "    def write_footer(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "415", "colour": "orange", "code": "        self.outfp.write('</pages>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "416", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "417", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "418", "colour": "orange", "code": "    def write_text(self, text):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "419", "colour": "orange", "code": "        self.outfp.write(enc(text, self.codec))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "420", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "421", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "422", "colour": "blue", "code": "    def receive_layout(self, ltpage):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "423", "colour": "orange", "code": "        def show_group(item):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "424", "colour": "orange", "code": "            if isinstance(item, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "425", "colour": "orange", "code": "                self.outfp.write('<textbox id=\"%d\" bbox=\"%s\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "426", "colour": "orange", "code": "                                 (item.index, bbox2str(item.bbox)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "427", "colour": "orange", "code": "            elif isinstance(item, LTTextGroup):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "428", "colour": "orange", "code": "                self.outfp.write('<textgroup bbox=\"%s\">\\n' % bbox2str(item.bbox))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "429", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "430", "colour": "orange", "code": "                    show_group(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "431", "colour": "orange", "code": "                self.outfp.write('</textgroup>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "432", "colour": "orange", "code": "            return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "433", "colour": "blue", "code": "        def render(item):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "434", "colour": "orange", "code": "            if isinstance(item, LTPage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "435", "colour": "orange", "code": "                self.outfp.write('<page id=\"%s\" bbox=\"%s\" rotate=\"%d\">\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "436", "colour": "orange", "code": "                                 (item.pageid, bbox2str(item.bbox), item.rotate))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "437", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "438", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "439", "colour": "orange", "code": "                if item.groups is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "440", "colour": "orange", "code": "                    self.outfp.write('<layout>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "441", "colour": "orange", "code": "                    for group in item.groups:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "442", "colour": "orange", "code": "                        show_group(group)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "443", "colour": "orange", "code": "                    self.outfp.write('</layout>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "444", "colour": "orange", "code": "                self.outfp.write('</page>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "445", "colour": "orange", "code": "            elif isinstance(item, LTLine):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "446", "colour": "orange", "code": "                self.outfp.write('<line linewidth=\"%d\" bbox=\"%s\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "447", "colour": "orange", "code": "                                 (item.linewidth, bbox2str(item.bbox)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "448", "colour": "orange", "code": "            elif isinstance(item, LTRect):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "449", "colour": "orange", "code": "                self.outfp.write('<rect linewidth=\"%d\" bbox=\"%s\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "450", "colour": "orange", "code": "                                 (item.linewidth, bbox2str(item.bbox)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "451", "colour": "orange", "code": "            elif isinstance(item, LTCurve):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "452", "colour": "orange", "code": "                self.outfp.write('<curve linewidth=\"%d\" bbox=\"%s\" pts=\"%s\"/>\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "453", "colour": "orange", "code": "                                 (item.linewidth, bbox2str(item.bbox), item.get_pts()))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "454", "colour": "orange", "code": "            elif isinstance(item, LTFigure):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "455", "colour": "orange", "code": "                self.outfp.write('<figure name=\"%s\" bbox=\"%s\">\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "456", "colour": "orange", "code": "                                 (item.name, bbox2str(item.bbox)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "457", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "458", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "459", "colour": "orange", "code": "                self.outfp.write('</figure>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "460", "colour": "orange", "code": "            elif isinstance(item, LTTextLine):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "461", "colour": "orange", "code": "                self.outfp.write('<textline bbox=\"%s\">\\n' % bbox2str(item.bbox))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "462", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "463", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "464", "colour": "orange", "code": "                self.outfp.write('</textline>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "465", "colour": "orange", "code": "            elif isinstance(item, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "466", "colour": "orange", "code": "                wmode = ''\n", "error": "none", "author": "tom@organisms.be"}, {"index": "467", "colour": "orange", "code": "                if isinstance(item, LTTextBoxVertical):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "468", "colour": "orange", "code": "                    wmode = ' wmode=\"vertical\"'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "469", "colour": "orange", "code": "                self.outfp.write('<textbox id=\"%d\" bbox=\"%s\"%s>\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "470", "colour": "orange", "code": "                                 (item.index, bbox2str(item.bbox), wmode))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "471", "colour": "orange", "code": "                for child in item:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "472", "colour": "orange", "code": "                    render(child)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "473", "colour": "orange", "code": "                self.outfp.write('</textbox>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "474", "colour": "orange", "code": "            elif isinstance(item, LTChar):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "475", "colour": "orange", "code": "                self.outfp.write('<text font=\"%s\" bbox=\"%s\" size=\"%.3f\">' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "476", "colour": "orange", "code": "                                 (enc(item.fontname), bbox2str(item.bbox), item.size))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "477", "colour": "orange", "code": "                self.write_text(item.get_text())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "478", "colour": "orange", "code": "                self.outfp.write('</text>\\n')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "479", "colour": "orange", "code": "            elif isinstance(item, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "480", "colour": "orange", "code": "                self.outfp.write('<text>%s</text>\\n' % item.get_text())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "481", "colour": "orange", "code": "            elif isinstance(item, LTImage):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "482", "colour": "orange", "code": "                if self.outdir:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "483", "colour": "orange", "code": "                    name = self.write_image(item)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "484", "colour": "orange", "code": "                    self.outfp.write('<image src=\"%s\" width=\"%d\" height=\"%d\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "485", "colour": "orange", "code": "                                     (enc(name), item.width, item.height))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "486", "colour": "orange", "code": "                else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "487", "colour": "orange", "code": "                    self.outfp.write('<image width=\"%d\" height=\"%d\" />\\n' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "488", "colour": "orange", "code": "                                     (item.width, item.height))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "489", "colour": "orange", "code": "            else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "490", "colour": "orange", "code": "                assert 0, item\n", "error": "none", "author": "tom@organisms.be"}, {"index": "491", "colour": "orange", "code": "            return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "492", "colour": "orange", "code": "        render(ltpage)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "493", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "494", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "495", "colour": "orange", "code": "    def close(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "496", "colour": "orange", "code": "        self.write_footer()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "497", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}]}