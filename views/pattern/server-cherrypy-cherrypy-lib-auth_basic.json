{"path": "/home/asumal/git/cs410/pattern/pattern/server/cherrypy/cherrypy/lib/auth_basic.py", "lines": [[{"error": "C", "line": "1", "code": "# This file is part of CherryPy <http://www.cherrypy.org/>\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "2", "code": "# -*- coding: utf-8 -*-\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "3", "code": "# vim:ts=4:sw=4:expandtab:fileencoding=utf-8\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "4", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "5", "code": "__doc__ = \"\"\"This module provides a CherryPy 3.x tool which implements\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "none", "line": "6", "code": "the server-side of HTTP Basic Access Authentication, as described in :rfc:`2617`.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "7", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "8", "code": "Example usage, using the built-in checkpassword_dict function which uses a dict\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "9", "code": "as the credentials store::\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "10", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "11", "code": "    userpassdict = {'bird' : 'bebop', 'ornette' : 'wayout'}\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "12", "code": "    checkpassword = cherrypy.lib.auth_basic.checkpassword_dict(userpassdict)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "13", "code": "    basic_auth = {'tools.auth_basic.on': True,\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "14", "code": "                  'tools.auth_basic.realm': 'earth',\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "15", "code": "                  'tools.auth_basic.checkpassword': checkpassword,\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "16", "code": "    }\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "17", "code": "    app_config = { '/' : basic_auth }\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "18", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "19", "code": "\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "20", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "21", "code": "__author__ = 'visteya'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "22", "code": "__date__ = 'April 2009'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "23", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "24", "code": "import binascii\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "25", "code": "from cherrypy._cpcompat import base64_decode\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "26", "code": "import cherrypy\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "27", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "28", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "29", "code": "def checkpassword_dict(user_password_dict):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "30", "code": "    \"\"\"Returns a checkpassword function which checks credentials\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "31", "code": "    against a dictionary of the form: {username : password}.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "32", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "33", "code": "    If you want a simple dictionary-based authentication scheme, use\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "34", "code": "    checkpassword_dict(my_credentials_dict) as the value for the\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "35", "code": "    checkpassword argument to basic_auth().\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "36", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "37", "code": "    def checkpassword(realm, user, password):\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "C", "line": "38", "code": "        p = user_password_dict.get(user)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "39", "code": "        return p and p == password or False\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "40", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "41", "code": "    return checkpassword\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "42", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "43", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "44", "code": "def basic_auth(realm, checkpassword, debug=False):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "45", "code": "    \"\"\"A CherryPy tool which hooks at before_handler to perform\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "46", "code": "    HTTP Basic Access Authentication, as specified in :rfc:`2617`.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "47", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "48", "code": "    If the request has an 'authorization' header with a 'Basic' scheme, this\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "49", "code": "    tool attempts to authenticate the credentials supplied in that header.  If\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "50", "code": "    the request has no 'authorization' header, or if it does but the scheme is\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "51", "code": "    not 'Basic', or if authentication fails, the tool sends a 401 response with\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "52", "code": "    a 'WWW-Authenticate' Basic header.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "53", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "54", "code": "    realm\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "55", "code": "        A string containing the authentication realm.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "56", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "57", "code": "    checkpassword\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "58", "code": "        A callable which checks the authentication credentials.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "59", "code": "        Its signature is checkpassword(realm, username, password). where\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "60", "code": "        username and password are the values obtained from the request's\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "61", "code": "        'authorization' header.  If authentication succeeds, checkpassword\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "62", "code": "        returns True, else it returns False.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "63", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "64", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "65", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "66", "code": "    if '\"' in realm:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "67", "code": "        raise ValueError('Realm cannot contain the \" (quote) character.')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "68", "code": "    request = cherrypy.serving.request\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "69", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "70", "code": "    auth_header = request.headers.get('authorization')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "71", "code": "    if auth_header is not None:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "72", "code": "        try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "73", "code": "            scheme, params = auth_header.split(' ', 1)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "74", "code": "            if scheme.lower() == 'basic':\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "75", "code": "                username, password = base64_decode(params).split(':', 1)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "76", "code": "                if checkpassword(realm, username, password):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "77", "code": "                    if debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "78", "code": "                        cherrypy.log('Auth succeeded', 'TOOLS.AUTH_BASIC')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "79", "code": "                    request.login = username\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "80", "code": "                    return # successful authentication\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "81", "code": "        except (ValueError, binascii.Error): # split() error, base64.decodestring() error\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "82", "code": "            raise cherrypy.HTTPError(400, 'Bad Request')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "83", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "84", "code": "    # Respond with 401 status and a WWW-Authenticate header\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "85", "code": "    cherrypy.serving.response.headers['www-authenticate'] = 'Basic realm=\"%s\"' % realm\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "86", "code": "    raise cherrypy.HTTPError(401, \"You are not authorized to access that resource\")\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "87", "code": "\n", "colour": "black", "author": "tom@organisms.be"}]]}