{"path": "/home/asumal/git/cs410/pattern/pattern/web/pdf/arcfour.py", "lines": [{"index": "1", "colour": "orange", "code": "#!/usr/bin/env python2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "2", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "3", "colour": "orange", "code": "\"\"\" Python implementation of Arcfour encryption algorithm.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "4", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "5", "colour": "orange", "code": "This code is in the public domain.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "6", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "7", "colour": "orange", "code": "\"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "8", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "9", "colour": "orange", "code": "##  Arcfour\n", "error": "none", "author": "tom@organisms.be"}, {"index": "10", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "11", "colour": "blue", "code": "class Arcfour(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "12", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "13", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "14", "colour": "orange", "code": "    >>> Arcfour('Key').process('Plaintext').encode('hex')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "15", "colour": "orange", "code": "    'bbf316e8d940af0ad3'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "16", "colour": "orange", "code": "    >>> Arcfour('Wiki').process('pedia').encode('hex')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "17", "colour": "orange", "code": "    '1021bf0420'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "18", "colour": "orange", "code": "    >>> Arcfour('Secret').process('Attack at dawn').encode('hex')\n", "error": "none", "author": "tom@organisms.be"}, {"index": "19", "colour": "orange", "code": "    '45a01f645fc35b383552544b9bf5'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "20", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "21", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "22", "colour": "orange", "code": "    def __init__(self, key):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "23", "colour": "orange", "code": "        s = range(256)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "24", "colour": "orange", "code": "        j = 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "25", "colour": "orange", "code": "        klen = len(key)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "26", "colour": "orange", "code": "        for i in xrange(256):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "27", "colour": "orange", "code": "            j = (j + s[i] + ord(key[i % klen])) % 256\n", "error": "none", "author": "tom@organisms.be"}, {"index": "28", "colour": "orange", "code": "            (s[i], s[j]) = (s[j], s[i])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "29", "colour": "orange", "code": "        self.s = s\n", "error": "none", "author": "tom@organisms.be"}, {"index": "30", "colour": "orange", "code": "        (self.i, self.j) = (0, 0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "31", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "32", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "33", "colour": "orange", "code": "    def process(self, data):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "34", "colour": "orange", "code": "        (i, j) = (self.i, self.j)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "35", "colour": "orange", "code": "        s = self.s\n", "error": "none", "author": "tom@organisms.be"}, {"index": "36", "colour": "orange", "code": "        r = ''\n", "error": "none", "author": "tom@organisms.be"}, {"index": "37", "colour": "orange", "code": "        for c in data:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "38", "colour": "orange", "code": "            i = (i+1) % 256\n", "error": "none", "author": "tom@organisms.be"}, {"index": "39", "colour": "orange", "code": "            j = (j+s[i]) % 256\n", "error": "none", "author": "tom@organisms.be"}, {"index": "40", "colour": "orange", "code": "            (s[i], s[j]) = (s[j], s[i])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "41", "colour": "orange", "code": "            k = s[(s[i]+s[j]) % 256]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "42", "colour": "orange", "code": "            r += chr(ord(c) ^ k)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "43", "colour": "orange", "code": "        (self.i, self.j) = (i, j)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "44", "colour": "orange", "code": "        return r\n", "error": "none", "author": "tom@organisms.be"}, {"index": "45", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "46", "colour": "orange", "code": "# test\n", "error": "none", "author": "tom@organisms.be"}, {"index": "47", "colour": "orange", "code": "if __name__ == '__main__':\n", "error": "none", "author": "tom@organisms.be"}, {"index": "48", "colour": "orange", "code": "    import doctest\n", "error": "none", "author": "tom@organisms.be"}, {"index": "49", "colour": "orange", "code": "    doctest.testmod()\n", "error": "none", "author": "tom@organisms.be"}]}