{"path": "/home/asumal/git/cs410/pattern/pattern/web/pdf/arcfour.py", "lines": [[{"error": "none", "line": "1", "code": "#!/usr/bin/env python2\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "2", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "3", "code": "\"\"\" Python implementation of Arcfour encryption algorithm.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "4", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "5", "code": "This code is in the public domain.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "6", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "7", "code": "\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "8", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "9", "code": "##  Arcfour\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "10", "code": "##\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "R", "line": "11", "code": "class Arcfour(object):\n", "colour": "green", "author": "tom@organisms.be"}, {"error": "none", "line": "12", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "13", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "14", "code": "    >>> Arcfour('Key').process('Plaintext').encode('hex')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "15", "code": "    'bbf316e8d940af0ad3'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "16", "code": "    >>> Arcfour('Wiki').process('pedia').encode('hex')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "17", "code": "    '1021bf0420'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "18", "code": "    >>> Arcfour('Secret').process('Attack at dawn').encode('hex')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "19", "code": "    '45a01f645fc35b383552544b9bf5'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "20", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "21", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "22", "code": "    def __init__(self, key):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "23", "code": "        s = range(256)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "24", "code": "        j = 0\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "25", "code": "        klen = len(key)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "26", "code": "        for i in xrange(256):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "27", "code": "            j = (j + s[i] + ord(key[i % klen])) % 256\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "28", "code": "            (s[i], s[j]) = (s[j], s[i])\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "29", "code": "        self.s = s\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "30", "code": "        (self.i, self.j) = (0, 0)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "31", "code": "        return\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "32", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "33", "code": "    def process(self, data):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "34", "code": "        (i, j) = (self.i, self.j)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "35", "code": "        s = self.s\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "36", "code": "        r = ''\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "37", "code": "        for c in data:\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "38", "code": "            i = (i+1) % 256\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "39", "code": "            j = (j+s[i]) % 256\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "40", "code": "            (s[i], s[j]) = (s[j], s[i])\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "41", "code": "            k = s[(s[i]+s[j]) % 256]\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "42", "code": "            r += chr(ord(c) ^ k)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "43", "code": "        (self.i, self.j) = (i, j)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "44", "code": "        return r\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "45", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "46", "code": "# test\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "47", "code": "if __name__ == '__main__':\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "48", "code": "    import doctest\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "49", "code": "    doctest.testmod()\n", "colour": "black", "author": "tom@organisms.be"}]]}