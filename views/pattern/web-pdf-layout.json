{"path": "/home/asumal/git/cs410/pattern/pattern/web/pdf/layout.py", "lines": [{"index": "1", "colour": "orange", "code": "#!/usr/bin/env python2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "2", "colour": "green", "code": "import sys\n", "error": "W", "author": "tom@organisms.be"}, {"index": "3", "colour": "green", "code": "from utils import INF, Plane, get_bound, uniq, csort, fsplit\n", "error": "W", "author": "tom@organisms.be"}, {"index": "4", "colour": "green", "code": "from utils import bbox2str, matrix2str, apply_matrix_pt\n", "error": "W", "author": "tom@organisms.be"}, {"index": "5", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "6", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "7", "colour": "orange", "code": "##  IndexAssigner\n", "error": "none", "author": "tom@organisms.be"}, {"index": "8", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "9", "colour": "blue", "code": "class IndexAssigner(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "10", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "11", "colour": "orange", "code": "    def __init__(self, index=0):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "12", "colour": "orange", "code": "        self.index = index\n", "error": "none", "author": "tom@organisms.be"}, {"index": "13", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "14", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "15", "colour": "orange", "code": "    def run(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "16", "colour": "orange", "code": "        if isinstance(obj, LTTextBox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "17", "colour": "orange", "code": "            obj.index = self.index\n", "error": "none", "author": "tom@organisms.be"}, {"index": "18", "colour": "orange", "code": "            self.index += 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "19", "colour": "orange", "code": "        elif isinstance(obj, LTTextGroup):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "20", "colour": "orange", "code": "            for x in obj:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "21", "colour": "orange", "code": "                self.run(x)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "22", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "23", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "24", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "25", "colour": "orange", "code": "##  LAParams\n", "error": "none", "author": "tom@organisms.be"}, {"index": "26", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "27", "colour": "blue", "code": "class LAParams(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "28", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "29", "colour": "blue", "code": "    def __init__(self,\n", "error": "R", "author": "tom@organisms.be"}, {"index": "30", "colour": "orange", "code": "                 line_overlap=0.5,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "31", "colour": "orange", "code": "                 char_margin=2.0,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "32", "colour": "orange", "code": "                 line_margin=0.5,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "33", "colour": "orange", "code": "                 word_margin=0.1,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "34", "colour": "orange", "code": "                 boxes_flow=0.5,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "35", "colour": "orange", "code": "                 detect_vertical=False,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "36", "colour": "orange", "code": "                 all_texts=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "37", "colour": "orange", "code": "        self.line_overlap = line_overlap\n", "error": "none", "author": "tom@organisms.be"}, {"index": "38", "colour": "orange", "code": "        self.char_margin = char_margin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "39", "colour": "orange", "code": "        self.line_margin = line_margin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "40", "colour": "orange", "code": "        self.word_margin = word_margin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "41", "colour": "orange", "code": "        self.boxes_flow = boxes_flow\n", "error": "none", "author": "tom@organisms.be"}, {"index": "42", "colour": "orange", "code": "        self.detect_vertical = detect_vertical\n", "error": "none", "author": "tom@organisms.be"}, {"index": "43", "colour": "orange", "code": "        self.all_texts = all_texts\n", "error": "none", "author": "tom@organisms.be"}, {"index": "44", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "45", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "46", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "47", "colour": "orange", "code": "        return ('<LAParams: char_margin=%.1f, line_margin=%.1f, word_margin=%.1f all_texts=%r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "48", "colour": "orange", "code": "                (self.char_margin, self.line_margin, self.word_margin, self.all_texts))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "49", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "50", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "51", "colour": "orange", "code": "##  LTItem\n", "error": "none", "author": "tom@organisms.be"}, {"index": "52", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "53", "colour": "blue", "code": "class LTItem(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "54", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "55", "colour": "blue", "code": "    def analyze(self, laparams):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "56", "colour": "orange", "code": "        \"\"\"Perform the layout analysis.\"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "57", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "58", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "59", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "60", "colour": "orange", "code": "##  LTText\n", "error": "none", "author": "tom@organisms.be"}, {"index": "61", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "62", "colour": "blue", "code": "class LTText(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "63", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "64", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "65", "colour": "orange", "code": "        return ('<%s %r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "66", "colour": "orange", "code": "                (self.__class__.__name__, self.get_text()))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "67", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "68", "colour": "orange", "code": "    def get_text(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "69", "colour": "orange", "code": "        raise NotImplementedError\n", "error": "none", "author": "tom@organisms.be"}, {"index": "70", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "71", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "72", "colour": "orange", "code": "##  LTComponent\n", "error": "none", "author": "tom@organisms.be"}, {"index": "73", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "74", "colour": "orange", "code": "class LTComponent(LTItem):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "75", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "76", "colour": "orange", "code": "    def __init__(self, bbox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "77", "colour": "orange", "code": "        LTItem.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "78", "colour": "orange", "code": "        self.set_bbox(bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "79", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "80", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "81", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "82", "colour": "orange", "code": "        return ('<%s %s>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "83", "colour": "orange", "code": "                (self.__class__.__name__, bbox2str(self.bbox)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "84", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "85", "colour": "orange", "code": "    def set_bbox(self, (x0,y0,x1,y1)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "86", "colour": "green", "code": "        self.x0 = x0\n", "error": "W", "author": "tom@organisms.be"}, {"index": "87", "colour": "green", "code": "        self.y0 = y0\n", "error": "W", "author": "tom@organisms.be"}, {"index": "88", "colour": "green", "code": "        self.x1 = x1\n", "error": "W", "author": "tom@organisms.be"}, {"index": "89", "colour": "green", "code": "        self.y1 = y1\n", "error": "W", "author": "tom@organisms.be"}, {"index": "90", "colour": "green", "code": "        self.width = x1-x0\n", "error": "W", "author": "tom@organisms.be"}, {"index": "91", "colour": "green", "code": "        self.height = y1-y0\n", "error": "W", "author": "tom@organisms.be"}, {"index": "92", "colour": "green", "code": "        self.bbox = (x0, y0, x1, y1)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "93", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "94", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "95", "colour": "orange", "code": "    def is_empty(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "96", "colour": "orange", "code": "        return self.width <= 0 or self.height <= 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "97", "colour": "orange", "code": "        \n", "error": "none", "author": "tom@organisms.be"}, {"index": "98", "colour": "orange", "code": "    def is_hoverlap(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "99", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "100", "colour": "orange", "code": "        return obj.x0 <= self.x1 and self.x0 <= obj.x1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "101", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "102", "colour": "orange", "code": "    def hdistance(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "103", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "104", "colour": "orange", "code": "        if self.is_hoverlap(obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "105", "colour": "orange", "code": "            return 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "106", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "107", "colour": "orange", "code": "            return min(abs(self.x0-obj.x1), abs(self.x1-obj.x0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "108", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "109", "colour": "orange", "code": "    def hoverlap(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "110", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "111", "colour": "orange", "code": "        if self.is_hoverlap(obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "112", "colour": "orange", "code": "            return min(abs(self.x0-obj.x1), abs(self.x1-obj.x0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "113", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "114", "colour": "orange", "code": "            return 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "115", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "116", "colour": "orange", "code": "    def is_voverlap(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "117", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "118", "colour": "orange", "code": "        return obj.y0 <= self.y1 and self.y0 <= obj.y1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "119", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "120", "colour": "orange", "code": "    def vdistance(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "121", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "122", "colour": "orange", "code": "        if self.is_voverlap(obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "123", "colour": "orange", "code": "            return 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "124", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "125", "colour": "orange", "code": "            return min(abs(self.y0-obj.y1), abs(self.y1-obj.y0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "126", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "127", "colour": "orange", "code": "    def voverlap(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "128", "colour": "orange", "code": "        assert isinstance(obj, LTComponent)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "129", "colour": "orange", "code": "        if self.is_voverlap(obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "130", "colour": "orange", "code": "            return min(abs(self.y0-obj.y1), abs(self.y1-obj.y0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "131", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "132", "colour": "orange", "code": "            return 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "133", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "134", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "135", "colour": "orange", "code": "##  LTCurve\n", "error": "none", "author": "tom@organisms.be"}, {"index": "136", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "137", "colour": "orange", "code": "class LTCurve(LTComponent):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "138", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "139", "colour": "orange", "code": "    def __init__(self, linewidth, pts):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "140", "colour": "orange", "code": "        LTComponent.__init__(self, get_bound(pts))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "141", "colour": "orange", "code": "        self.pts = pts\n", "error": "none", "author": "tom@organisms.be"}, {"index": "142", "colour": "orange", "code": "        self.linewidth = linewidth\n", "error": "none", "author": "tom@organisms.be"}, {"index": "143", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "144", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "145", "colour": "orange", "code": "    def get_pts(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "146", "colour": "orange", "code": "        return ','.join( '%.3f,%.3f' % p for p in self.pts )\n", "error": "none", "author": "tom@organisms.be"}, {"index": "147", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "148", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "149", "colour": "orange", "code": "##  LTLine\n", "error": "none", "author": "tom@organisms.be"}, {"index": "150", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "151", "colour": "orange", "code": "class LTLine(LTCurve):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "152", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "153", "colour": "orange", "code": "    def __init__(self, linewidth, p0, p1):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "154", "colour": "orange", "code": "        LTCurve.__init__(self, linewidth, [p0, p1])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "155", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "156", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "157", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "158", "colour": "orange", "code": "##  LTRect\n", "error": "none", "author": "tom@organisms.be"}, {"index": "159", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "160", "colour": "orange", "code": "class LTRect(LTCurve):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "161", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "162", "colour": "orange", "code": "    def __init__(self, linewidth, (x0,y0,x1,y1)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "163", "colour": "orange", "code": "        LTCurve.__init__(self, linewidth, [(x0,y0), (x1,y0), (x1,y1), (x0,y1)])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "164", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "165", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "166", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "167", "colour": "orange", "code": "##  LTImage\n", "error": "none", "author": "tom@organisms.be"}, {"index": "168", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "169", "colour": "orange", "code": "class LTImage(LTComponent):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "170", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "171", "colour": "orange", "code": "    def __init__(self, name, stream, bbox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "172", "colour": "orange", "code": "        LTComponent.__init__(self, bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "173", "colour": "orange", "code": "        self.name = name\n", "error": "none", "author": "tom@organisms.be"}, {"index": "174", "colour": "orange", "code": "        self.stream = stream\n", "error": "none", "author": "tom@organisms.be"}, {"index": "175", "colour": "orange", "code": "        self.srcsize = (stream.get_any(('W', 'Width')),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "176", "colour": "orange", "code": "                        stream.get_any(('H', 'Height')))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "177", "colour": "orange", "code": "        self.imagemask = stream.get_any(('IM', 'ImageMask'))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "178", "colour": "orange", "code": "        self.bits = stream.get_any(('BPC', 'BitsPerComponent'), 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "179", "colour": "orange", "code": "        self.colorspace = stream.get_any(('CS', 'ColorSpace'))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "180", "colour": "orange", "code": "        if not isinstance(self.colorspace, list):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "181", "colour": "orange", "code": "            self.colorspace = [self.colorspace]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "182", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "183", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "184", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "185", "colour": "orange", "code": "        return ('<%s(%s) %s %r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "186", "colour": "orange", "code": "                (self.__class__.__name__, self.name,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "187", "colour": "orange", "code": "                 bbox2str(self.bbox), self.srcsize))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "188", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "189", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "190", "colour": "orange", "code": "##  LTAnon\n", "error": "none", "author": "tom@organisms.be"}, {"index": "191", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "192", "colour": "orange", "code": "class LTAnon(LTItem, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "193", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "194", "colour": "orange", "code": "    def __init__(self, text):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "195", "colour": "orange", "code": "        self._text = text\n", "error": "none", "author": "tom@organisms.be"}, {"index": "196", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "197", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "198", "colour": "orange", "code": "    def get_text(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "199", "colour": "orange", "code": "        return self._text\n", "error": "none", "author": "tom@organisms.be"}, {"index": "200", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "201", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "202", "colour": "orange", "code": "##  LTChar\n", "error": "none", "author": "tom@organisms.be"}, {"index": "203", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "204", "colour": "orange", "code": "class LTChar(LTComponent, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "205", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "206", "colour": "blue", "code": "    def __init__(self, matrix, font, fontsize, scaling, rise, text, textwidth, textdisp):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "207", "colour": "orange", "code": "        LTText.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "208", "colour": "orange", "code": "        self._text = text\n", "error": "none", "author": "tom@organisms.be"}, {"index": "209", "colour": "orange", "code": "        self.matrix = matrix\n", "error": "none", "author": "tom@organisms.be"}, {"index": "210", "colour": "orange", "code": "        self.fontname = font.fontname\n", "error": "none", "author": "tom@organisms.be"}, {"index": "211", "colour": "orange", "code": "        self.adv = textwidth * fontsize * scaling\n", "error": "none", "author": "tom@organisms.be"}, {"index": "212", "colour": "orange", "code": "        # compute the boundary rectangle.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "213", "colour": "orange", "code": "        if font.is_vertical():\n", "error": "none", "author": "tom@organisms.be"}, {"index": "214", "colour": "orange", "code": "            # vertical\n", "error": "none", "author": "tom@organisms.be"}, {"index": "215", "colour": "orange", "code": "            width = font.get_width() * fontsize\n", "error": "none", "author": "tom@organisms.be"}, {"index": "216", "colour": "orange", "code": "            (vx,vy) = textdisp\n", "error": "none", "author": "tom@organisms.be"}, {"index": "217", "colour": "orange", "code": "            if vx is None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "218", "colour": "orange", "code": "                vx = width/2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "219", "colour": "orange", "code": "            else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "220", "colour": "orange", "code": "                vx = vx * fontsize * .001\n", "error": "none", "author": "tom@organisms.be"}, {"index": "221", "colour": "orange", "code": "            vy = (1000 - vy) * fontsize * .001\n", "error": "none", "author": "tom@organisms.be"}, {"index": "222", "colour": "orange", "code": "            tx = -vx\n", "error": "none", "author": "tom@organisms.be"}, {"index": "223", "colour": "orange", "code": "            ty = vy + rise\n", "error": "none", "author": "tom@organisms.be"}, {"index": "224", "colour": "orange", "code": "            bll = (tx, ty+self.adv)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "225", "colour": "orange", "code": "            bur = (tx+width, ty)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "226", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "227", "colour": "orange", "code": "            # horizontal\n", "error": "none", "author": "tom@organisms.be"}, {"index": "228", "colour": "orange", "code": "            height = font.get_height() * fontsize\n", "error": "none", "author": "tom@organisms.be"}, {"index": "229", "colour": "orange", "code": "            descent = font.get_descent() * fontsize\n", "error": "none", "author": "tom@organisms.be"}, {"index": "230", "colour": "orange", "code": "            ty = descent + rise\n", "error": "none", "author": "tom@organisms.be"}, {"index": "231", "colour": "orange", "code": "            bll = (0, ty)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "232", "colour": "orange", "code": "            bur = (self.adv, ty+height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "233", "colour": "green", "code": "        (a,b,c,d,e,f) = self.matrix\n", "error": "W", "author": "tom@organisms.be"}, {"index": "234", "colour": "orange", "code": "        self.upright = (0 < a*d*scaling and b*c <= 0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "235", "colour": "orange", "code": "        (x0,y0) = apply_matrix_pt(self.matrix, bll)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "236", "colour": "orange", "code": "        (x1,y1) = apply_matrix_pt(self.matrix, bur)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "237", "colour": "orange", "code": "        if x1 < x0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "238", "colour": "orange", "code": "            (x0,x1) = (x1,x0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "239", "colour": "orange", "code": "        if y1 < y0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "240", "colour": "orange", "code": "            (y0,y1) = (y1,y0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "241", "colour": "orange", "code": "        LTComponent.__init__(self, (x0,y0,x1,y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "242", "colour": "orange", "code": "        if font.is_vertical():\n", "error": "none", "author": "tom@organisms.be"}, {"index": "243", "colour": "orange", "code": "            self.size = self.width\n", "error": "none", "author": "tom@organisms.be"}, {"index": "244", "colour": "orange", "code": "        else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "245", "colour": "orange", "code": "            self.size = self.height\n", "error": "none", "author": "tom@organisms.be"}, {"index": "246", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "247", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "248", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "249", "colour": "orange", "code": "        return ('<%s %s matrix=%s font=%r adv=%s text=%r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "250", "colour": "orange", "code": "                (self.__class__.__name__, bbox2str(self.bbox), \n", "error": "none", "author": "tom@organisms.be"}, {"index": "251", "colour": "orange", "code": "                 matrix2str(self.matrix), self.fontname, self.adv,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "252", "colour": "orange", "code": "                 self.get_text()))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "253", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "254", "colour": "orange", "code": "    def get_text(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "255", "colour": "orange", "code": "        return self._text\n", "error": "none", "author": "tom@organisms.be"}, {"index": "256", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "257", "colour": "blue", "code": "    def is_compatible(self, obj):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "258", "colour": "orange", "code": "        \"\"\"Returns True if two characters can coexist in the same line.\"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "259", "colour": "orange", "code": "        return True\n", "error": "none", "author": "tom@organisms.be"}, {"index": "260", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "261", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "262", "colour": "orange", "code": "##  LTContainer\n", "error": "none", "author": "tom@organisms.be"}, {"index": "263", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "264", "colour": "orange", "code": "class LTContainer(LTComponent):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "265", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "266", "colour": "orange", "code": "    def __init__(self, bbox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "267", "colour": "orange", "code": "        LTComponent.__init__(self, bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "268", "colour": "orange", "code": "        self._objs = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "269", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "270", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "271", "colour": "orange", "code": "    def __iter__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "272", "colour": "orange", "code": "        return iter(self._objs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "273", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "274", "colour": "orange", "code": "    def __len__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "275", "colour": "orange", "code": "        return len(self._objs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "276", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "277", "colour": "orange", "code": "    def add(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "278", "colour": "orange", "code": "        self._objs.append(obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "279", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "280", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "281", "colour": "orange", "code": "    def extend(self, objs):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "282", "colour": "orange", "code": "        for obj in objs:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "283", "colour": "orange", "code": "            self.add(obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "284", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "285", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "286", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "287", "colour": "orange", "code": "        for obj in self._objs:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "288", "colour": "orange", "code": "            obj.analyze(laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "289", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "290", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "291", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "292", "colour": "orange", "code": "##  LTExpandableContainer\n", "error": "none", "author": "tom@organisms.be"}, {"index": "293", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "294", "colour": "orange", "code": "class LTExpandableContainer(LTContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "295", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "296", "colour": "orange", "code": "    def __init__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "297", "colour": "orange", "code": "        LTContainer.__init__(self, (+INF,+INF,-INF,-INF))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "298", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "299", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "300", "colour": "orange", "code": "    def add(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "301", "colour": "orange", "code": "        LTContainer.add(self, obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "302", "colour": "orange", "code": "        self.set_bbox((min(self.x0, obj.x0), min(self.y0, obj.y0),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "303", "colour": "orange", "code": "                       max(self.x1, obj.x1), max(self.y1, obj.y1)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "304", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "305", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "306", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "307", "colour": "orange", "code": "##  LTTextContainer\n", "error": "none", "author": "tom@organisms.be"}, {"index": "308", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "309", "colour": "orange", "code": "class LTTextContainer(LTExpandableContainer, LTText):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "310", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "311", "colour": "orange", "code": "    def __init__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "312", "colour": "orange", "code": "        LTText.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "313", "colour": "orange", "code": "        LTExpandableContainer.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "314", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "315", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "316", "colour": "orange", "code": "    def get_text(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "317", "colour": "orange", "code": "        return ''.join( obj.get_text() for obj in self if isinstance(obj, LTText) )\n", "error": "none", "author": "tom@organisms.be"}, {"index": "318", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "319", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "320", "colour": "orange", "code": "##  LTTextLine\n", "error": "none", "author": "tom@organisms.be"}, {"index": "321", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "322", "colour": "orange", "code": "class LTTextLine(LTTextContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "323", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "324", "colour": "orange", "code": "    def __init__(self, word_margin):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "325", "colour": "orange", "code": "        LTTextContainer.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "326", "colour": "orange", "code": "        self.word_margin = word_margin\n", "error": "none", "author": "tom@organisms.be"}, {"index": "327", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "328", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "329", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "330", "colour": "orange", "code": "        return ('<%s %s %r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "331", "colour": "orange", "code": "                (self.__class__.__name__, bbox2str(self.bbox),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "332", "colour": "orange", "code": "                 self.get_text()))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "333", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "334", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "335", "colour": "orange", "code": "        LTTextContainer.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "336", "colour": "orange", "code": "        LTContainer.add(self, LTAnon('\\n'))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "337", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "338", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "339", "colour": "orange", "code": "    def find_neighbors(self, plane, ratio):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "340", "colour": "orange", "code": "        raise NotImplementedError\n", "error": "none", "author": "tom@organisms.be"}, {"index": "341", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "342", "colour": "blue", "code": "class LTTextLineHorizontal(LTTextLine):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "343", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "344", "colour": "orange", "code": "    def __init__(self, word_margin):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "345", "colour": "orange", "code": "        LTTextLine.__init__(self, word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "346", "colour": "orange", "code": "        self._x1 = +INF\n", "error": "none", "author": "tom@organisms.be"}, {"index": "347", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "348", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "349", "colour": "orange", "code": "    def add(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "350", "colour": "orange", "code": "        if isinstance(obj, LTChar) and self.word_margin:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "351", "colour": "orange", "code": "            margin = self.word_margin * obj.width\n", "error": "none", "author": "tom@organisms.be"}, {"index": "352", "colour": "orange", "code": "            if self._x1 < obj.x0-margin:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "353", "colour": "orange", "code": "                LTContainer.add(self, LTAnon(' '))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "354", "colour": "orange", "code": "        self._x1 = obj.x1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "355", "colour": "orange", "code": "        LTTextLine.add(self, obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "356", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "357", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "358", "colour": "orange", "code": "    def find_neighbors(self, plane, ratio):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "359", "colour": "orange", "code": "        h = ratio*self.height\n", "error": "none", "author": "tom@organisms.be"}, {"index": "360", "colour": "orange", "code": "        objs = plane.find((self.x0, self.y0-h, self.x1, self.y1+h))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "361", "colour": "orange", "code": "        return [ obj for obj in objs if isinstance(obj, LTTextLineHorizontal) ]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "362", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "363", "colour": "blue", "code": "class LTTextLineVertical(LTTextLine):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "364", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "365", "colour": "orange", "code": "    def __init__(self, word_margin):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "366", "colour": "orange", "code": "        LTTextLine.__init__(self, word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "367", "colour": "orange", "code": "        self._y0 = -INF\n", "error": "none", "author": "tom@organisms.be"}, {"index": "368", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "369", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "370", "colour": "orange", "code": "    def add(self, obj):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "371", "colour": "orange", "code": "        if isinstance(obj, LTChar) and self.word_margin:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "372", "colour": "orange", "code": "            margin = self.word_margin * obj.height\n", "error": "none", "author": "tom@organisms.be"}, {"index": "373", "colour": "orange", "code": "            if obj.y1+margin < self._y0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "374", "colour": "orange", "code": "                LTContainer.add(self, LTAnon(' '))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "375", "colour": "orange", "code": "        self._y0 = obj.y0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "376", "colour": "orange", "code": "        LTTextLine.add(self, obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "377", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "378", "colour": "orange", "code": "        \n", "error": "none", "author": "tom@organisms.be"}, {"index": "379", "colour": "orange", "code": "    def find_neighbors(self, plane, ratio):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "380", "colour": "orange", "code": "        w = ratio*self.width\n", "error": "none", "author": "tom@organisms.be"}, {"index": "381", "colour": "orange", "code": "        objs = plane.find((self.x0-w, self.y0, self.x1+w, self.y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "382", "colour": "orange", "code": "        return [ obj for obj in objs if isinstance(obj, LTTextLineVertical) ]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "383", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "384", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "385", "colour": "orange", "code": "##  LTTextBox\n", "error": "none", "author": "tom@organisms.be"}, {"index": "386", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "387", "colour": "orange", "code": "##  A set of text objects that are grouped within\n", "error": "none", "author": "tom@organisms.be"}, {"index": "388", "colour": "orange", "code": "##  a certain rectangular area.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "389", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "390", "colour": "orange", "code": "class LTTextBox(LTTextContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "391", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "392", "colour": "orange", "code": "    def __init__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "393", "colour": "orange", "code": "        LTTextContainer.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "394", "colour": "orange", "code": "        self.index = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "395", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "396", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "397", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "398", "colour": "orange", "code": "        return ('<%s(%s) %s %r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "399", "colour": "orange", "code": "                (self.__class__.__name__,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "400", "colour": "orange", "code": "                 self.index, bbox2str(self.bbox), self.get_text()))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "401", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "402", "colour": "blue", "code": "class LTTextBoxHorizontal(LTTextBox):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "403", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "404", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "405", "colour": "orange", "code": "        LTTextBox.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "406", "colour": "orange", "code": "        self._objs = csort(self._objs, key=lambda obj: -obj.y1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "407", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "408", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "409", "colour": "blue", "code": "    def get_writing_mode(self):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "410", "colour": "orange", "code": "        return 'lr-tb'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "411", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "412", "colour": "blue", "code": "class LTTextBoxVertical(LTTextBox):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "413", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "414", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "415", "colour": "orange", "code": "        LTTextBox.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "416", "colour": "orange", "code": "        self._objs = csort(self._objs, key=lambda obj: -obj.x1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "417", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "418", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "419", "colour": "blue", "code": "    def get_writing_mode(self):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "420", "colour": "orange", "code": "        return 'tb-rl'\n", "error": "none", "author": "tom@organisms.be"}, {"index": "421", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "422", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "423", "colour": "orange", "code": "##  LTTextGroup\n", "error": "none", "author": "tom@organisms.be"}, {"index": "424", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "425", "colour": "orange", "code": "class LTTextGroup(LTTextContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "426", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "427", "colour": "orange", "code": "    def __init__(self, objs):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "428", "colour": "orange", "code": "        LTTextContainer.__init__(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "429", "colour": "orange", "code": "        self.extend(objs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "430", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "431", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "432", "colour": "blue", "code": "class LTTextGroupLRTB(LTTextGroup):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "433", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "434", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "435", "colour": "orange", "code": "        LTTextGroup.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "436", "colour": "orange", "code": "        # reorder the objects from top-left to bottom-right.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "437", "colour": "orange", "code": "        self._objs = csort(self._objs, key=lambda obj:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "438", "colour": "orange", "code": "                           (1-laparams.boxes_flow)*(obj.x0) -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "439", "colour": "orange", "code": "                           (1+laparams.boxes_flow)*(obj.y0+obj.y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "440", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "441", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "442", "colour": "blue", "code": "class LTTextGroupTBRL(LTTextGroup):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "443", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "444", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "445", "colour": "orange", "code": "        LTTextGroup.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "446", "colour": "orange", "code": "        # reorder the objects from top-right to bottom-left.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "447", "colour": "orange", "code": "        self._objs = csort(self._objs, key=lambda obj:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "448", "colour": "orange", "code": "                           -(1+laparams.boxes_flow)*(obj.x0+obj.x1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "449", "colour": "orange", "code": "                           -(1-laparams.boxes_flow)*(obj.y1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "450", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "451", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "452", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "453", "colour": "orange", "code": "##  LTLayoutContainer\n", "error": "none", "author": "tom@organisms.be"}, {"index": "454", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "455", "colour": "orange", "code": "class LTLayoutContainer(LTContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "456", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "457", "colour": "orange", "code": "    def __init__(self, bbox):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "458", "colour": "orange", "code": "        LTContainer.__init__(self, bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "459", "colour": "orange", "code": "        self.groups = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "460", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "461", "colour": "orange", "code": "        \n", "error": "none", "author": "tom@organisms.be"}, {"index": "462", "colour": "blue", "code": "    def get_textlines(self, laparams, objs):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "463", "colour": "orange", "code": "        obj0 = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "464", "colour": "orange", "code": "        line = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "465", "colour": "orange", "code": "        for obj1 in objs:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "466", "colour": "orange", "code": "            if obj0 is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "467", "colour": "orange", "code": "                k = 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "468", "colour": "orange", "code": "                if (obj0.is_compatible(obj1) and obj0.is_voverlap(obj1) and \n", "error": "none", "author": "tom@organisms.be"}, {"index": "469", "colour": "orange", "code": "                    min(obj0.height, obj1.height) * laparams.line_overlap < obj0.voverlap(obj1) and\n", "error": "none", "author": "tom@organisms.be"}, {"index": "470", "colour": "orange", "code": "                    obj0.hdistance(obj1) < max(obj0.width, obj1.width) * laparams.char_margin):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "471", "colour": "orange", "code": "                    # obj0 and obj1 is horizontally aligned:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "472", "colour": "orange", "code": "                    #\n", "error": "none", "author": "tom@organisms.be"}, {"index": "473", "colour": "orange", "code": "                    #   +------+ - - -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "474", "colour": "orange", "code": "                    #   | obj0 | - - +------+   -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "475", "colour": "orange", "code": "                    #   |      |     | obj1 |   | (line_overlap)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "476", "colour": "orange", "code": "                    #   +------+ - - |      |   -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "477", "colour": "orange", "code": "                    #          - - - +------+\n", "error": "none", "author": "tom@organisms.be"}, {"index": "478", "colour": "orange", "code": "                    #\n", "error": "none", "author": "tom@organisms.be"}, {"index": "479", "colour": "orange", "code": "                    #          |<--->|\n", "error": "none", "author": "tom@organisms.be"}, {"index": "480", "colour": "orange", "code": "                    #        (char_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "481", "colour": "orange", "code": "                    k |= 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "482", "colour": "orange", "code": "                if (laparams.detect_vertical and\n", "error": "none", "author": "tom@organisms.be"}, {"index": "483", "colour": "orange", "code": "                    obj0.is_compatible(obj1) and obj0.is_hoverlap(obj1) and \n", "error": "none", "author": "tom@organisms.be"}, {"index": "484", "colour": "orange", "code": "                    min(obj0.width, obj1.width) * laparams.line_overlap < obj0.hoverlap(obj1) and\n", "error": "none", "author": "tom@organisms.be"}, {"index": "485", "colour": "orange", "code": "                    obj0.vdistance(obj1) < max(obj0.height, obj1.height) * laparams.char_margin):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "486", "colour": "orange", "code": "                    # obj0 and obj1 is vertically aligned:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "487", "colour": "orange", "code": "                    #\n", "error": "none", "author": "tom@organisms.be"}, {"index": "488", "colour": "orange", "code": "                    #   +------+\n", "error": "none", "author": "tom@organisms.be"}, {"index": "489", "colour": "orange", "code": "                    #   | obj0 |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "490", "colour": "orange", "code": "                    #   |      |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "491", "colour": "orange", "code": "                    #   +------+ - - -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "492", "colour": "orange", "code": "                    #     |    |     | (char_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "493", "colour": "orange", "code": "                    #     +------+ - -\n", "error": "none", "author": "tom@organisms.be"}, {"index": "494", "colour": "orange", "code": "                    #     | obj1 |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "495", "colour": "orange", "code": "                    #     |      |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "496", "colour": "orange", "code": "                    #     +------+\n", "error": "none", "author": "tom@organisms.be"}, {"index": "497", "colour": "orange", "code": "                    #\n", "error": "none", "author": "tom@organisms.be"}, {"index": "498", "colour": "orange", "code": "                    #     |<-->|\n", "error": "none", "author": "tom@organisms.be"}, {"index": "499", "colour": "orange", "code": "                    #   (line_overlap)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "500", "colour": "orange", "code": "                    k |= 2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "501", "colour": "orange", "code": "                if ( (k & 1 and isinstance(line, LTTextLineHorizontal)) or\n", "error": "none", "author": "tom@organisms.be"}, {"index": "502", "colour": "orange", "code": "                     (k & 2 and isinstance(line, LTTextLineVertical)) ):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "503", "colour": "orange", "code": "                    line.add(obj1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "504", "colour": "orange", "code": "                elif line is not None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "505", "colour": "orange", "code": "                    yield line\n", "error": "none", "author": "tom@organisms.be"}, {"index": "506", "colour": "orange", "code": "                    line = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "507", "colour": "orange", "code": "                else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "508", "colour": "orange", "code": "                    if k == 2:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "509", "colour": "orange", "code": "                        line = LTTextLineVertical(laparams.word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "510", "colour": "orange", "code": "                        line.add(obj0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "511", "colour": "orange", "code": "                        line.add(obj1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "512", "colour": "orange", "code": "                    elif k == 1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "513", "colour": "orange", "code": "                        line = LTTextLineHorizontal(laparams.word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "514", "colour": "orange", "code": "                        line.add(obj0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "515", "colour": "orange", "code": "                        line.add(obj1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "516", "colour": "orange", "code": "                    else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "517", "colour": "orange", "code": "                        line = LTTextLineHorizontal(laparams.word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "518", "colour": "orange", "code": "                        line.add(obj0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "519", "colour": "orange", "code": "                        yield line\n", "error": "none", "author": "tom@organisms.be"}, {"index": "520", "colour": "orange", "code": "                        line = None\n", "error": "none", "author": "tom@organisms.be"}, {"index": "521", "colour": "orange", "code": "            obj0 = obj1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "522", "colour": "orange", "code": "        if line is None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "523", "colour": "orange", "code": "            line = LTTextLineHorizontal(laparams.word_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "524", "colour": "orange", "code": "            line.add(obj0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "525", "colour": "orange", "code": "        yield line\n", "error": "none", "author": "tom@organisms.be"}, {"index": "526", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "527", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "528", "colour": "blue", "code": "    def get_textboxes(self, laparams, lines):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "529", "colour": "orange", "code": "        plane = Plane(lines)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "530", "colour": "orange", "code": "        boxes = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "531", "colour": "orange", "code": "        for line in lines:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "532", "colour": "orange", "code": "            neighbors = line.find_neighbors(plane, laparams.line_margin)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "533", "colour": "orange", "code": "            assert line in neighbors, line\n", "error": "none", "author": "tom@organisms.be"}, {"index": "534", "colour": "orange", "code": "            members = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "535", "colour": "orange", "code": "            for obj1 in neighbors:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "536", "colour": "orange", "code": "                members.append(obj1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "537", "colour": "orange", "code": "                if obj1 in boxes:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "538", "colour": "orange", "code": "                    members.extend(boxes.pop(obj1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "539", "colour": "orange", "code": "            if isinstance(line, LTTextLineHorizontal):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "540", "colour": "orange", "code": "                box = LTTextBoxHorizontal()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "541", "colour": "orange", "code": "            else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "542", "colour": "orange", "code": "                box = LTTextBoxVertical()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "543", "colour": "orange", "code": "            for obj in uniq(members):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "544", "colour": "orange", "code": "                box.add(obj)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "545", "colour": "orange", "code": "                boxes[obj] = box\n", "error": "none", "author": "tom@organisms.be"}, {"index": "546", "colour": "orange", "code": "        done = set()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "547", "colour": "orange", "code": "        for line in lines:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "548", "colour": "orange", "code": "            box = boxes[line]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "549", "colour": "orange", "code": "            if box in done: continue\n", "error": "none", "author": "tom@organisms.be"}, {"index": "550", "colour": "orange", "code": "            done.add(box)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "551", "colour": "orange", "code": "            yield box\n", "error": "none", "author": "tom@organisms.be"}, {"index": "552", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "553", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "554", "colour": "blue", "code": "    def group_textboxes(self, laparams, boxes):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "555", "colour": "orange", "code": "        def dist(obj1, obj2):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "556", "colour": "orange", "code": "            \"\"\"A distance function between two TextBoxes.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "557", "colour": "orange", "code": "            \n", "error": "none", "author": "tom@organisms.be"}, {"index": "558", "colour": "orange", "code": "            Consider the bounding rectangle for obj1 and obj2.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "559", "colour": "orange", "code": "            Return its area less the areas of obj1 and obj2, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "560", "colour": "orange", "code": "            shown as 'www' below. This value may be negative.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "561", "colour": "orange", "code": "                    +------+..........+ (x1,y1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "562", "colour": "orange", "code": "                    | obj1 |wwwwwwwwww:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "563", "colour": "orange", "code": "                    +------+www+------+\n", "error": "none", "author": "tom@organisms.be"}, {"index": "564", "colour": "orange", "code": "                    :wwwwwwwwww| obj2 |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "565", "colour": "orange", "code": "            (x0,y0) +..........+------+\n", "error": "none", "author": "tom@organisms.be"}, {"index": "566", "colour": "orange", "code": "            \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "567", "colour": "orange", "code": "            x0 = min(obj1.x0,obj2.x0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "568", "colour": "orange", "code": "            y0 = min(obj1.y0,obj2.y0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "569", "colour": "orange", "code": "            x1 = max(obj1.x1,obj2.x1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "570", "colour": "orange", "code": "            y1 = max(obj1.y1,obj2.y1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "571", "colour": "orange", "code": "            return ((x1-x0)*(y1-y0) - obj1.width*obj1.height - obj2.width*obj2.height)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "572", "colour": "orange", "code": "        def isany(obj1, obj2):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "573", "colour": "orange", "code": "            \"\"\"Check if there's any other object between obj1 and obj2.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "574", "colour": "orange", "code": "            \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "575", "colour": "orange", "code": "            x0 = min(obj1.x0,obj2.x0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "576", "colour": "orange", "code": "            y0 = min(obj1.y0,obj2.y0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "577", "colour": "orange", "code": "            x1 = max(obj1.x1,obj2.x1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "578", "colour": "orange", "code": "            y1 = max(obj1.y1,obj2.y1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "579", "colour": "orange", "code": "            objs = set(plane.find((x0,y0,x1,y1)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "580", "colour": "orange", "code": "            return objs.difference((obj1,obj2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "581", "colour": "green", "code": "        # XXX this still takes O(n^2)  :(\n", "error": "W", "author": "tom@organisms.be"}, {"index": "582", "colour": "orange", "code": "        dists = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "583", "colour": "orange", "code": "        for i in xrange(len(boxes)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "584", "colour": "orange", "code": "            obj1 = boxes[i]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "585", "colour": "orange", "code": "            for j in xrange(i+1, len(boxes)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "586", "colour": "orange", "code": "                obj2 = boxes[j]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "587", "colour": "orange", "code": "                dists.append((0, dist(obj1, obj2), obj1, obj2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "588", "colour": "orange", "code": "        dists.sort()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "589", "colour": "orange", "code": "        plane = Plane(boxes)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "590", "colour": "orange", "code": "        while dists:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "591", "colour": "orange", "code": "            (c,d,obj1,obj2) = dists.pop(0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "592", "colour": "orange", "code": "            if c == 0 and isany(obj1, obj2):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "593", "colour": "orange", "code": "                dists.append((1,d,obj1,obj2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "594", "colour": "orange", "code": "                continue\n", "error": "none", "author": "tom@organisms.be"}, {"index": "595", "colour": "orange", "code": "            if (isinstance(obj1, LTTextBoxVertical) or\n", "error": "none", "author": "tom@organisms.be"}, {"index": "596", "colour": "orange", "code": "                isinstance(obj1, LTTextGroupTBRL) or\n", "error": "none", "author": "tom@organisms.be"}, {"index": "597", "colour": "orange", "code": "                isinstance(obj2, LTTextBoxVertical) or\n", "error": "none", "author": "tom@organisms.be"}, {"index": "598", "colour": "orange", "code": "                isinstance(obj2, LTTextGroupTBRL)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "599", "colour": "orange", "code": "                group = LTTextGroupTBRL([obj1,obj2])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "600", "colour": "orange", "code": "            else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "601", "colour": "orange", "code": "                group = LTTextGroupLRTB([obj1,obj2])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "602", "colour": "orange", "code": "            plane.remove(obj1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "603", "colour": "orange", "code": "            plane.remove(obj2)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "604", "colour": "orange", "code": "            dists = [ (c,d,o1,o2) for (c,d,o1,o2) in dists\n", "error": "none", "author": "tom@organisms.be"}, {"index": "605", "colour": "orange", "code": "                      if o1 in plane and o2 in plane ]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "606", "colour": "orange", "code": "            for other in plane:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "607", "colour": "orange", "code": "                dists.append((0, dist(group,other), group, other))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "608", "colour": "orange", "code": "            dists.sort()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "609", "colour": "orange", "code": "            plane.add(group)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "610", "colour": "orange", "code": "        assert len(plane) == 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "611", "colour": "orange", "code": "        return list(plane)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "612", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "613", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "614", "colour": "orange", "code": "        # textobjs is a list of LTChar objects, i.e.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "615", "colour": "orange", "code": "        # it has all the individual characters in the page.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "616", "colour": "orange", "code": "        (textobjs, otherobjs) = fsplit(lambda obj: isinstance(obj, LTChar), self._objs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "617", "colour": "orange", "code": "        for obj in otherobjs:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "618", "colour": "orange", "code": "            obj.analyze(laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "619", "colour": "orange", "code": "        if not textobjs: return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "620", "colour": "orange", "code": "        textlines = list(self.get_textlines(laparams, textobjs))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "621", "colour": "green", "code": "        assert len(textobjs) <= sum( len(line._objs) for line in textlines )\n", "error": "W", "author": "tom@organisms.be"}, {"index": "622", "colour": "orange", "code": "        (empties, textlines) = fsplit(lambda obj: obj.is_empty(), textlines)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "623", "colour": "orange", "code": "        for obj in empties:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "624", "colour": "orange", "code": "            obj.analyze(laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "625", "colour": "orange", "code": "        textboxes = list(self.get_textboxes(laparams, textlines))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "626", "colour": "green", "code": "        assert len(textlines) == sum( len(box._objs) for box in textboxes )\n", "error": "W", "author": "tom@organisms.be"}, {"index": "627", "colour": "orange", "code": "        groups = self.group_textboxes(laparams, textboxes)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "628", "colour": "orange", "code": "        assigner = IndexAssigner()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "629", "colour": "orange", "code": "        for group in groups:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "630", "colour": "orange", "code": "            group.analyze(laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "631", "colour": "orange", "code": "            assigner.run(group)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "632", "colour": "orange", "code": "        textboxes.sort(key=lambda box:box.index)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "633", "colour": "orange", "code": "        self._objs = textboxes + otherobjs + empties\n", "error": "none", "author": "tom@organisms.be"}, {"index": "634", "colour": "orange", "code": "        self.groups = groups\n", "error": "none", "author": "tom@organisms.be"}, {"index": "635", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "636", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "637", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "638", "colour": "orange", "code": "##  LTFigure\n", "error": "none", "author": "tom@organisms.be"}, {"index": "639", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "640", "colour": "orange", "code": "class LTFigure(LTLayoutContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "641", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "642", "colour": "orange", "code": "    def __init__(self, name, bbox, matrix):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "643", "colour": "orange", "code": "        self.name = name\n", "error": "none", "author": "tom@organisms.be"}, {"index": "644", "colour": "orange", "code": "        self.matrix = matrix\n", "error": "none", "author": "tom@organisms.be"}, {"index": "645", "colour": "orange", "code": "        (x,y,w,h) = bbox\n", "error": "none", "author": "tom@organisms.be"}, {"index": "646", "colour": "orange", "code": "        bbox = get_bound( apply_matrix_pt(matrix, (p,q))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "647", "colour": "orange", "code": "                          for (p,q) in ((x,y), (x+w,y), (x,y+h), (x+w,y+h)) )\n", "error": "none", "author": "tom@organisms.be"}, {"index": "648", "colour": "orange", "code": "        LTLayoutContainer.__init__(self, bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "649", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "650", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "651", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "652", "colour": "orange", "code": "        return ('<%s(%s) %s matrix=%s>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "653", "colour": "orange", "code": "                (self.__class__.__name__, self.name,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "654", "colour": "orange", "code": "                 bbox2str(self.bbox), matrix2str(self.matrix)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "655", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "656", "colour": "orange", "code": "    def analyze(self, laparams):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "657", "colour": "orange", "code": "        if not laparams.all_texts: return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "658", "colour": "orange", "code": "        LTLayoutContainer.analyze(self, laparams)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "659", "colour": "orange", "code": "        return \n", "error": "none", "author": "tom@organisms.be"}, {"index": "660", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "661", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "662", "colour": "orange", "code": "##  LTPage\n", "error": "none", "author": "tom@organisms.be"}, {"index": "663", "colour": "orange", "code": "##\n", "error": "none", "author": "tom@organisms.be"}, {"index": "664", "colour": "orange", "code": "class LTPage(LTLayoutContainer):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "665", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "666", "colour": "orange", "code": "    def __init__(self, pageid, bbox, rotate=0):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "667", "colour": "orange", "code": "        LTLayoutContainer.__init__(self, bbox)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "668", "colour": "orange", "code": "        self.pageid = pageid\n", "error": "none", "author": "tom@organisms.be"}, {"index": "669", "colour": "orange", "code": "        self.rotate = rotate\n", "error": "none", "author": "tom@organisms.be"}, {"index": "670", "colour": "orange", "code": "        return\n", "error": "none", "author": "tom@organisms.be"}, {"index": "671", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "672", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "673", "colour": "orange", "code": "        return ('<%s(%r) %s rotate=%r>' %\n", "error": "none", "author": "tom@organisms.be"}, {"index": "674", "colour": "orange", "code": "                (self.__class__.__name__, self.pageid,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "675", "colour": "orange", "code": "                 bbox2str(self.bbox), self.rotate))\n", "error": "none", "author": "tom@organisms.be"}]}