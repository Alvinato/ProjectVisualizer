{"path": "/home/asumal/git/cs410/pattern/pattern/server/cherrypy/cherrypy/lib/auth_digest.py", "lines": [[{"error": "C", "line": "1", "code": "# This file is part of CherryPy <http://www.cherrypy.org/>\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "2", "code": "# -*- coding: utf-8 -*-\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "3", "code": "# vim:ts=4:sw=4:expandtab:fileencoding=utf-8\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "4", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "5", "code": "__doc__ = \"\"\"An implementation of the server-side of HTTP Digest Access\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "none", "line": "6", "code": "Authentication, which is described in :rfc:`2617`.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "7", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "8", "code": "Example usage, using the built-in get_ha1_dict_plain function which uses a dict\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "9", "code": "of plaintext passwords as the credentials store::\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "10", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "11", "code": "    userpassdict = {'alice' : '4x5istwelve'}\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "12", "code": "    get_ha1 = cherrypy.lib.auth_digest.get_ha1_dict_plain(userpassdict)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "13", "code": "    digest_auth = {'tools.auth_digest.on': True,\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "14", "code": "                   'tools.auth_digest.realm': 'wonderland',\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "15", "code": "                   'tools.auth_digest.get_ha1': get_ha1,\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "16", "code": "                   'tools.auth_digest.key': 'a565c27146791cfb',\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "17", "code": "    }\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "18", "code": "    app_config = { '/' : digest_auth }\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "19", "code": "\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "20", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "21", "code": "__author__ = 'visteya'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "22", "code": "__date__ = 'April 2009'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "23", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "24", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "25", "code": "import time\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "26", "code": "from cherrypy._cpcompat import parse_http_list, parse_keqv_list\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "27", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "28", "code": "import cherrypy\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "29", "code": "from cherrypy._cpcompat import md5, ntob\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "30", "code": "md5_hex = lambda s: md5(ntob(s)).hexdigest()\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "31", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "32", "code": "qop_auth = 'auth'\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "33", "code": "qop_auth_int = 'auth-int'\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "34", "code": "valid_qops = (qop_auth, qop_auth_int)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "35", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "36", "code": "valid_algorithms = ('MD5', 'MD5-sess')\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "37", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "38", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "39", "code": "def TRACE(msg):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "40", "code": "    cherrypy.log(msg, context='TOOLS.AUTH_DIGEST')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "41", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "42", "code": "# Three helper functions for users of the tool, providing three variants\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "43", "code": "# of get_ha1() functions for three different kinds of credential stores.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "44", "code": "def get_ha1_dict_plain(user_password_dict):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "45", "code": "    \"\"\"Returns a get_ha1 function which obtains a plaintext password from a\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "46", "code": "    dictionary of the form: {username : password}.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "47", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "48", "code": "    If you want a simple dictionary-based authentication scheme, with plaintext\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "49", "code": "    passwords, use get_ha1_dict_plain(my_userpass_dict) as the value for the\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "50", "code": "    get_ha1 argument to digest_auth().\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "51", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "52", "code": "    def get_ha1(realm, username):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "53", "code": "        password = user_password_dict.get(username)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "54", "code": "        if password:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "55", "code": "            return md5_hex('%s:%s:%s' % (username, realm, password))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "56", "code": "        return None\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "57", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "58", "code": "    return get_ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "59", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "60", "code": "def get_ha1_dict(user_ha1_dict):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "61", "code": "    \"\"\"Returns a get_ha1 function which obtains a HA1 password hash from a\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "62", "code": "    dictionary of the form: {username : HA1}.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "63", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "64", "code": "    If you want a dictionary-based authentication scheme, but with\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "65", "code": "    pre-computed HA1 hashes instead of plain-text passwords, use\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "66", "code": "    get_ha1_dict(my_userha1_dict) as the value for the get_ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "67", "code": "    argument to digest_auth().\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "68", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "69", "code": "    def get_ha1(realm, username):\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "E", "line": "70", "code": "        return user_ha1_dict.get(user)\n", "colour": "yellow", "author": "tom@organisms.be"}, {"error": "none", "line": "71", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "72", "code": "    return get_ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "73", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "74", "code": "def get_ha1_file_htdigest(filename):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "75", "code": "    \"\"\"Returns a get_ha1 function which obtains a HA1 password hash from a\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "76", "code": "    flat file with lines of the same format as that produced by the Apache\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "77", "code": "    htdigest utility. For example, for realm 'wonderland', username 'alice',\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "78", "code": "    and password '4x5istwelve', the htdigest line would be::\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "79", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "80", "code": "        alice:wonderland:3238cdfe91a8b2ed8e39646921a02d4c\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "81", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "82", "code": "    If you want to use an Apache htdigest file as the credentials store,\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "83", "code": "    then use get_ha1_file_htdigest(my_htdigest_file) as the value for the\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "84", "code": "    get_ha1 argument to digest_auth().  It is recommended that the filename\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "85", "code": "    argument be an absolute path, to avoid problems.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "86", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "87", "code": "    def get_ha1(realm, username):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "88", "code": "        result = None\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "89", "code": "        f = open(filename, 'r')\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "90", "code": "        for line in f:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "91", "code": "            u, r, ha1 = line.rstrip().split(':')\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "92", "code": "            if u == username and r == realm:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "93", "code": "                result = ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "94", "code": "                break\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "95", "code": "        f.close()\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "96", "code": "        return result\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "97", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "98", "code": "    return get_ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "99", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "100", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "101", "code": "def synthesize_nonce(s, key, timestamp=None):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "102", "code": "    \"\"\"Synthesize a nonce value which resists spoofing and can be checked for staleness.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "103", "code": "    Returns a string suitable as the value for 'nonce' in the www-authenticate header.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "104", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "105", "code": "    s\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "106", "code": "        A string related to the resource, such as the hostname of the server.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "107", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "108", "code": "    key\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "109", "code": "        A secret string known only to the server.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "110", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "111", "code": "    timestamp\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "112", "code": "        An integer seconds-since-the-epoch timestamp\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "113", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "114", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "115", "code": "    if timestamp is None:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "116", "code": "        timestamp = int(time.time())\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "117", "code": "    h = md5_hex('%s:%s:%s' % (timestamp, s, key))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "118", "code": "    nonce = '%s:%s' % (timestamp, h)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "119", "code": "    return nonce\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "120", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "121", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "122", "code": "def H(s):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "123", "code": "    \"\"\"The hash function H\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "124", "code": "    return md5_hex(s)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "125", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "126", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "R", "line": "127", "code": "class HttpDigestAuthorization (object):\n", "colour": "green", "author": "tom@organisms.be"}, {"error": "none", "line": "128", "code": "    \"\"\"Class to parse a Digest Authorization header and perform re-calculation\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "129", "code": "    of the digest.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "130", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "131", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "R", "line": "132", "code": "    def errmsg(self, s):\n", "colour": "green", "author": "tom@organisms.be"}, {"error": "none", "line": "133", "code": "        return 'Digest Authorization header: %s' % s\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "134", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "135", "code": "    def __init__(self, auth_header, http_method, debug=False):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "136", "code": "        self.http_method = http_method\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "137", "code": "        self.debug = debug\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "138", "code": "        scheme, params  = auth_header.split(\" \", 1)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "139", "code": "        self.scheme = scheme.lower()\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "140", "code": "        if self.scheme != 'digest':\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "141", "code": "            raise ValueError('Authorization scheme is not \"Digest\"')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "142", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "143", "code": "        self.auth_header = auth_header\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "144", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "145", "code": "        # make a dict of the params\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "146", "code": "        items = parse_http_list(params)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "147", "code": "        paramsd = parse_keqv_list(items)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "148", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "149", "code": "        self.realm = paramsd.get('realm')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "150", "code": "        self.username = paramsd.get('username')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "151", "code": "        self.nonce = paramsd.get('nonce')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "152", "code": "        self.uri = paramsd.get('uri')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "153", "code": "        self.method = paramsd.get('method')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "154", "code": "        self.response = paramsd.get('response') # the response digest\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "155", "code": "        self.algorithm = paramsd.get('algorithm', 'MD5')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "156", "code": "        self.cnonce = paramsd.get('cnonce')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "157", "code": "        self.opaque = paramsd.get('opaque')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "158", "code": "        self.qop = paramsd.get('qop') # qop\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "159", "code": "        self.nc = paramsd.get('nc') # nonce count\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "160", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "161", "code": "        # perform some correctness checks\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "162", "code": "        if self.algorithm not in valid_algorithms:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "163", "code": "            raise ValueError(self.errmsg(\"Unsupported value for algorithm: '%s'\" % self.algorithm))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "164", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "165", "code": "        has_reqd = self.username and \\\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "166", "code": "                   self.realm and \\\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "167", "code": "                   self.nonce and \\\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "168", "code": "                   self.uri and \\\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "169", "code": "                   self.response\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "170", "code": "        if not has_reqd:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "171", "code": "            raise ValueError(self.errmsg(\"Not all required parameters are present.\"))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "172", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "173", "code": "        if self.qop:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "174", "code": "            if self.qop not in valid_qops:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "175", "code": "                raise ValueError(self.errmsg(\"Unsupported value for qop: '%s'\" % self.qop))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "176", "code": "            if not (self.cnonce and self.nc):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "177", "code": "                raise ValueError(self.errmsg(\"If qop is sent then cnonce and nc MUST be present\"))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "178", "code": "        else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "179", "code": "            if self.cnonce or self.nc:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "180", "code": "                raise ValueError(self.errmsg(\"If qop is not sent, neither cnonce nor nc can be present\"))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "181", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "182", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "183", "code": "    def __str__(self):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "184", "code": "        return 'authorization : %s' % self.auth_header\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "185", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "186", "code": "    def validate_nonce(self, s, key):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "187", "code": "        \"\"\"Validate the nonce.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "188", "code": "        Returns True if nonce was generated by synthesize_nonce() and the timestamp\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "189", "code": "        is not spoofed, else returns False.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "190", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "191", "code": "        s\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "192", "code": "            A string related to the resource, such as the hostname of the server.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "193", "code": "            \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "194", "code": "        key\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "195", "code": "            A secret string known only to the server.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "196", "code": "        \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "197", "code": "        Both s and key must be the same values which were used to synthesize the nonce\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "198", "code": "        we are trying to validate.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "199", "code": "        \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "200", "code": "        try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "201", "code": "            timestamp, hashpart = self.nonce.split(':', 1)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "202", "code": "            s_timestamp, s_hashpart = synthesize_nonce(s, key, timestamp).split(':', 1)\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "none", "line": "203", "code": "            is_valid = s_hashpart == hashpart\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "204", "code": "            if self.debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "205", "code": "                TRACE('validate_nonce: %s' % is_valid)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "206", "code": "            return is_valid\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "207", "code": "        except ValueError: # split() error\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "208", "code": "            pass\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "209", "code": "        return False\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "210", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "211", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "212", "code": "    def is_nonce_stale(self, max_age_seconds=600):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "213", "code": "        \"\"\"Returns True if a validated nonce is stale. The nonce contains a\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "214", "code": "        timestamp in plaintext and also a secure hash of the timestamp. You should\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "215", "code": "        first validate the nonce to ensure the plaintext timestamp is not spoofed.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "216", "code": "        \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "217", "code": "        try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "W", "line": "218", "code": "            timestamp, hashpart = self.nonce.split(':', 1)\n", "colour": "purple", "author": "tom@organisms.be"}, {"error": "none", "line": "219", "code": "            if int(timestamp) + max_age_seconds > int(time.time()):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "220", "code": "                return False\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "221", "code": "        except ValueError: # int() error\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "222", "code": "            pass\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "223", "code": "        if self.debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "224", "code": "            TRACE(\"nonce is stale\")\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "225", "code": "        return True\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "226", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "227", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "228", "code": "    def HA2(self, entity_body=''):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "229", "code": "        \"\"\"Returns the H(A2) string. See :rfc:`2617` section 3.2.2.3.\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "230", "code": "        # RFC 2617 3.2.2.3\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "231", "code": "        # If the \"qop\" directive's value is \"auth\" or is unspecified, then A2 is:\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "232", "code": "        #    A2 = method \":\" digest-uri-value\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "233", "code": "        #\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "234", "code": "        # If the \"qop\" value is \"auth-int\", then A2 is:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "235", "code": "        #    A2 = method \":\" digest-uri-value \":\" H(entity-body)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "236", "code": "        if self.qop is None or self.qop == \"auth\":\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "237", "code": "            a2 = '%s:%s' % (self.http_method, self.uri)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "238", "code": "        elif self.qop == \"auth-int\":\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "239", "code": "            a2 = \"%s:%s:%s\" % (self.http_method, self.uri, H(entity_body))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "240", "code": "        else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "241", "code": "            # in theory, this should never happen, since I validate qop in __init__()\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "242", "code": "            raise ValueError(self.errmsg(\"Unrecognized value for qop!\"))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "243", "code": "        return H(a2)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "244", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "245", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "246", "code": "    def request_digest(self, ha1, entity_body=''):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "247", "code": "        \"\"\"Calculates the Request-Digest. See :rfc:`2617` section 3.2.2.1.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "248", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "249", "code": "        ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "250", "code": "            The HA1 string obtained from the credentials store.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "251", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "252", "code": "        entity_body\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "253", "code": "            If 'qop' is set to 'auth-int', then A2 includes a hash\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "254", "code": "            of the \"entity body\".  The entity body is the part of the\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "255", "code": "            message which follows the HTTP headers. See :rfc:`2617` section\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "256", "code": "            4.3.  This refers to the entity the user agent sent in the request which\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "257", "code": "            has the Authorization header. Typically GET requests don't have an entity,\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "258", "code": "            and POST requests do.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "259", "code": "        \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "260", "code": "        \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "261", "code": "        ha2 = self.HA2(entity_body)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "262", "code": "        # Request-Digest -- RFC 2617 3.2.2.1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "263", "code": "        if self.qop:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "264", "code": "            req = \"%s:%s:%s:%s:%s\" % (self.nonce, self.nc, self.cnonce, self.qop, ha2)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "265", "code": "        else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "266", "code": "            req = \"%s:%s\" % (self.nonce, ha2)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "267", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "268", "code": "        # RFC 2617 3.2.2.2\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "269", "code": "        #\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "270", "code": "        # If the \"algorithm\" directive's value is \"MD5\" or is unspecified, then A1 is:\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "271", "code": "        # A1 = unq(username-value) \":\" unq(realm-value) \":\" passwd\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "272", "code": "        #\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "273", "code": "        # If the \"algorithm\" directive's value is \"MD5-sess\", then A1 is\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "274", "code": "        # calculated only once - on the first request by the client following\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "275", "code": "        # receipt of a WWW-Authenticate challenge from the server.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "276", "code": "        # A1 = H( unq(username-value) \":\" unq(realm-value) \":\" passwd )\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "277", "code": "        #         \":\" unq(nonce-value) \":\" unq(cnonce-value)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "278", "code": "        if self.algorithm == 'MD5-sess':\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "279", "code": "            ha1 = H('%s:%s:%s' % (ha1, self.nonce, self.cnonce))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "280", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "281", "code": "        digest = H('%s:%s' % (ha1, req))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "282", "code": "        return digest\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "283", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "284", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "285", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "R", "line": "286", "code": "def www_authenticate(realm, key, algorithm='MD5', nonce=None, qop=qop_auth, stale=False):\n", "colour": "green", "author": "tom@organisms.be"}, {"error": "none", "line": "287", "code": "    \"\"\"Constructs a WWW-Authenticate header for Digest authentication.\"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "288", "code": "    if qop not in valid_qops:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "289", "code": "        raise ValueError(\"Unsupported value for qop: '%s'\" % qop)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "290", "code": "    if algorithm not in valid_algorithms:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "291", "code": "        raise ValueError(\"Unsupported value for algorithm: '%s'\" % algorithm)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "292", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "293", "code": "    if nonce is None:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "294", "code": "        nonce = synthesize_nonce(realm, key)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "295", "code": "    s = 'Digest realm=\"%s\", nonce=\"%s\", algorithm=\"%s\", qop=\"%s\"' % (\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "296", "code": "                realm, nonce, algorithm, qop)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "297", "code": "    if stale:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "298", "code": "        s += ', stale=\"true\"'\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "299", "code": "    return s\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "300", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "301", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "302", "code": "def digest_auth(realm, get_ha1, key, debug=False):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "303", "code": "    \"\"\"A CherryPy tool which hooks at before_handler to perform\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "304", "code": "    HTTP Digest Access Authentication, as specified in :rfc:`2617`.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "305", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "306", "code": "    If the request has an 'authorization' header with a 'Digest' scheme, this\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "307", "code": "    tool authenticates the credentials supplied in that header.  If\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "308", "code": "    the request has no 'authorization' header, or if it does but the scheme is\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "309", "code": "    not \"Digest\", or if authentication fails, the tool sends a 401 response with\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "310", "code": "    a 'WWW-Authenticate' Digest header.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "311", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "312", "code": "    realm\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "313", "code": "        A string containing the authentication realm.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "314", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "315", "code": "    get_ha1\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "316", "code": "        A callable which looks up a username in a credentials store\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "317", "code": "        and returns the HA1 string, which is defined in the RFC to be\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "318", "code": "        MD5(username : realm : password).  The function's signature is:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "319", "code": "        ``get_ha1(realm, username)``\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "320", "code": "        where username is obtained from the request's 'authorization' header.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "321", "code": "        If username is not found in the credentials store, get_ha1() returns\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "322", "code": "        None.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "323", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "324", "code": "    key\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "325", "code": "        A secret string known only to the server, used in the synthesis of nonces.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "326", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "327", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "328", "code": "    request = cherrypy.serving.request\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "329", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "330", "code": "    auth_header = request.headers.get('authorization')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "331", "code": "    nonce_is_stale = False\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "332", "code": "    if auth_header is not None:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "333", "code": "        try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "334", "code": "            auth = HttpDigestAuthorization(auth_header, request.method, debug=debug)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "335", "code": "        except ValueError:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "336", "code": "            raise cherrypy.HTTPError(400, \"The Authorization header could not be parsed.\")\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "337", "code": "        \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "338", "code": "        if debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "339", "code": "            TRACE(str(auth))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "340", "code": "        \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "341", "code": "        if auth.validate_nonce(realm, key):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "342", "code": "            ha1 = get_ha1(realm, auth.username)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "343", "code": "            if ha1 is not None:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "344", "code": "                # note that for request.body to be available we need to hook in at\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "345", "code": "                # before_handler, not on_start_resource like 3.1.x digest_auth does.\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "346", "code": "                digest = auth.request_digest(ha1, entity_body=request.body)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "347", "code": "                if digest == auth.response: # authenticated\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "348", "code": "                    if debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "349", "code": "                        TRACE(\"digest matches auth.response\")\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "350", "code": "                    # Now check if nonce is stale.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "351", "code": "                    # The choice of ten minutes' lifetime for nonce is somewhat arbitrary\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "352", "code": "                    nonce_is_stale = auth.is_nonce_stale(max_age_seconds=600)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "353", "code": "                    if not nonce_is_stale:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "354", "code": "                        request.login = auth.username\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "355", "code": "                        if debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "356", "code": "                            TRACE(\"authentication of %s successful\" % auth.username)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "357", "code": "                        return\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "358", "code": "    \n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "359", "code": "    # Respond with 401 status and a WWW-Authenticate header\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "360", "code": "    header = www_authenticate(realm, key, stale=nonce_is_stale)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "361", "code": "    if debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "362", "code": "        TRACE(header)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "363", "code": "    cherrypy.serving.response.headers['WWW-Authenticate'] = header\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "364", "code": "    raise cherrypy.HTTPError(401, \"You are not authorized to access that resource\")\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "365", "code": "\n", "colour": "black", "author": "tom@organisms.be"}]]}