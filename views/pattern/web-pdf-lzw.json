{"path": "/home/asumal/git/cs410/pattern/pattern/web/pdf/lzw.py", "lines": [[{"error": "C", "line": "1", "code": "#!/usr/bin/env python2\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "2", "code": "import sys\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "3", "code": "try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "4", "code": "    from cStringIO import StringIO\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "5", "code": "except ImportError:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "6", "code": "    from StringIO import StringIO\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "7", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "8", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "9", "code": "##  LZWDecoder\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "10", "code": "##\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "11", "code": "class LZWDecoder(object):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "12", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "13", "code": "    debug = 0\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "14", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "15", "code": "    def __init__(self, fp):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "16", "code": "        self.fp = fp\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "17", "code": "        self.buff = 0\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "18", "code": "        self.bpos = 8\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "19", "code": "        self.nbits = 9\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "20", "code": "        self.table = None\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "21", "code": "        self.prevbuf = None\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "22", "code": "        return\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "23", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "24", "code": "    def readbits(self, bits):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "25", "code": "        v = 0\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "26", "code": "        while 1:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "27", "code": "            # the number of remaining bits we can get from the current buffer.\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "28", "code": "            r = 8-self.bpos\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "29", "code": "            if bits <= r:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "30", "code": "                # |-----8-bits-----|\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "31", "code": "                # |-bpos-|-bits-|  |\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "32", "code": "                # |      |----r----|\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "33", "code": "                v = (v<<bits) | ((self.buff>>(r-bits)) & ((1<<bits)-1))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "34", "code": "                self.bpos += bits\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "35", "code": "                break\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "36", "code": "            else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "37", "code": "                # |-----8-bits-----|\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "38", "code": "                # |-bpos-|---bits----...\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "39", "code": "                # |      |----r----|\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "40", "code": "                v = (v<<r) | (self.buff & ((1<<r)-1))\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "41", "code": "                bits -= r\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "42", "code": "                x = self.fp.read(1)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "43", "code": "                if not x: raise EOFError\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "44", "code": "                self.buff = ord(x)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "45", "code": "                self.bpos = 0\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "46", "code": "        return v\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "47", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "48", "code": "    def feed(self, code):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "49", "code": "        x = ''\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "50", "code": "        if code == 256:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "51", "code": "            self.table = [ chr(c) for c in xrange(256) ] # 0-255\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "52", "code": "            self.table.append(None) # 256\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "53", "code": "            self.table.append(None) # 257\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "54", "code": "            self.prevbuf = ''\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "55", "code": "            self.nbits = 9\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "56", "code": "        elif code == 257:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "57", "code": "            pass\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "58", "code": "        elif not self.prevbuf:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "59", "code": "            x = self.prevbuf = self.table[code]\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "60", "code": "        else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "61", "code": "            if code < len(self.table):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "62", "code": "                x = self.table[code]\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "63", "code": "                self.table.append(self.prevbuf+x[0])\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "64", "code": "            else:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "65", "code": "                self.table.append(self.prevbuf+self.prevbuf[0])\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "66", "code": "                x = self.table[code]\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "C", "line": "67", "code": "            l = len(self.table)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "68", "code": "            if l == 511:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "69", "code": "                self.nbits = 10\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "70", "code": "            elif l == 1023:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "71", "code": "                self.nbits = 11\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "72", "code": "            elif l == 2047:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "73", "code": "                self.nbits = 12\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "74", "code": "            self.prevbuf = x\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "75", "code": "        return x\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "76", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "77", "code": "    def run(self):\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "78", "code": "        while 1:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "79", "code": "            try:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "80", "code": "                code = self.readbits(self.nbits)\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "81", "code": "            except EOFError:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "82", "code": "                break\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "83", "code": "            x = self.feed(code)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "84", "code": "            yield x\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "85", "code": "            if self.debug:\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "86", "code": "                print >>sys.stderr, ('nbits=%d, code=%d, output=%r, table=%r' %\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "87", "code": "                                     (self.nbits, code, x, self.table[258:]))\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "88", "code": "        return\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "89", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "90", "code": "# lzwdecode\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "91", "code": "def lzwdecode(data):\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "92", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "93", "code": "    >>> lzwdecode('\\x80\\x0b\\x60\\x50\\x22\\x0c\\x0c\\x85\\x01')\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "94", "code": "    '\\x2d\\x2d\\x2d\\x2d\\x2d\\x41\\x2d\\x2d\\x2d\\x42'\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "95", "code": "    \"\"\"\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "C", "line": "96", "code": "    fp = StringIO(data)\n", "colour": "blue", "author": "tom@organisms.be"}, {"error": "none", "line": "97", "code": "    return ''.join(LZWDecoder(fp).run())\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "98", "code": "\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "99", "code": "if __name__ == '__main__':\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "100", "code": "    import doctest\n", "colour": "black", "author": "tom@organisms.be"}, {"error": "none", "line": "101", "code": "    doctest.testmod()\n", "colour": "black", "author": "tom@organisms.be"}]]}