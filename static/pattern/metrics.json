{"path": "/home/asumal/git/cs410/pattern/pattern/metrics.py", "lines": [{"index": "1", "colour": "orange", "code": "#### PATTERN | METRICS #############################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "2", "colour": "orange", "code": "# coding: utf-8\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "3", "colour": "orange", "code": "# Copyright (c) 2010 University of Antwerp, Belgium\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "4", "colour": "orange", "code": "# Author: Tom De Smedt <tom@organisms.be>\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "5", "colour": "orange", "code": "# License: BSD (see LICENSE.txt for details).\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "6", "colour": "orange", "code": "# http://www.clips.ua.ac.be/pages/pattern\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "7", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "8", "colour": "orange", "code": "import sys\n", "error": "none", "author": "tom@organisms.be"}, {"index": "9", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "10", "colour": "orange", "code": "from time import time\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "11", "colour": "orange", "code": "from math import sqrt, floor, modf, exp, pi, log\n", "error": "none", "author": "tom@organisms.be"}, {"index": "12", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "13", "colour": "orange", "code": "from collections import defaultdict, deque\n", "error": "none", "author": "tom@organisms.be"}, {"index": "14", "colour": "orange", "code": "from itertools   import chain\n", "error": "none", "author": "tom@organisms.be"}, {"index": "15", "colour": "orange", "code": "from operator    import itemgetter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "16", "colour": "orange", "code": "from heapq       import nlargest\n", "error": "none", "author": "tom@organisms.be"}, {"index": "17", "colour": "orange", "code": "from bisect      import bisect_right\n", "error": "none", "author": "tom@organisms.be"}, {"index": "18", "colour": "orange", "code": "from random      import gauss\n", "error": "none", "author": "tom@organisms.be"}, {"index": "19", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "20", "colour": "orange", "code": "####################################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "21", "colour": "orange", "code": "# Simple implementation of Counter for Python 2.5 and 2.6.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "22", "colour": "orange", "code": "# See also: http://code.activestate.com/recipes/576611/\n", "error": "none", "author": "tom@organisms.be"}, {"index": "23", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "24", "colour": "orange", "code": "class Counter(dict):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "25", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "26", "colour": "green", "code": "    def __init__(self, iterable=None, **kwargs):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "27", "colour": "orange", "code": "        self.update(iterable, **kwargs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "28", "colour": "orange", "code": "                        \n", "error": "none", "author": "tom@organisms.be"}, {"index": "29", "colour": "blue", "code": "    def __missing__(self, k):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "30", "colour": "orange", "code": "        return 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "31", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "32", "colour": "orange", "code": "    def update(self, iterable=None, **kwargs):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "33", "colour": "orange", "code": "        \"\"\" Updates counter with the tallies from the given iterable, dictionary or Counter.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "34", "colour": "orange", "code": "        \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "35", "colour": "orange", "code": "        if kwargs:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "36", "colour": "orange", "code": "            self.update(kwargs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "37", "colour": "orange", "code": "        if hasattr(iterable, \"items\"):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "38", "colour": "orange", "code": "            for k, v in iterable.items(): \n", "error": "none", "author": "tom@organisms.be"}, {"index": "39", "colour": "orange", "code": "                self[k] = self.get(k, 0) + v\n", "error": "none", "author": "tom@organisms.be"}, {"index": "40", "colour": "orange", "code": "        elif hasattr(iterable, \"__getitem__\") \\\n", "error": "none", "author": "tom@organisms.be"}, {"index": "41", "colour": "orange", "code": "          or hasattr(iterable, \"__iter__\"):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "42", "colour": "orange", "code": "            for k in iterable: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "43", "colour": "orange", "code": "                self[k] = self.get(k, 0) + 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "44", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "45", "colour": "orange", "code": "    def most_common(self, n=None):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "46", "colour": "orange", "code": "        \"\"\" Returns a list of the n most common (element, count)-tuples.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "47", "colour": "orange", "code": "        \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "48", "colour": "orange", "code": "        if n is None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "49", "colour": "orange", "code": "            return sorted(self.items(), key=itemgetter(1), reverse=True)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "50", "colour": "orange", "code": "        return nlargest(n, self.items(), key=itemgetter(1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "51", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "52", "colour": "orange", "code": "    def copy(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "53", "colour": "orange", "code": "        return Counter(self)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "54", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "55", "colour": "orange", "code": "    def __delitem__(self, k):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "56", "colour": "orange", "code": "        if k in self: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "57", "colour": "orange", "code": "            dict.__delitem__(self, k)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "58", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "59", "colour": "orange", "code": "    def __repr__(self):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "60", "colour": "orange", "code": "        return \"Counter({%s})\" % \", \".join(\"%r: %r\" % e for e in self.most_common())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "61", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "62", "colour": "orange", "code": "try: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "63", "colour": "orange", "code": "    # Import Counter from Python 2.7+ if possible.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "64", "colour": "orange", "code": "    from collections import Counter\n", "error": "none", "author": "tom@organisms.be"}, {"index": "65", "colour": "green", "code": "except:\n", "error": "W", "author": "tom@organisms.be"}, {"index": "66", "colour": "orange", "code": "    pass\n", "error": "none", "author": "tom@organisms.be"}, {"index": "67", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "68", "colour": "orange", "code": "def cumsum(iterable):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "69", "colour": "orange", "code": "    \"\"\" Returns an iterator over the cumulative sum of values in the given list.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "70", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "71", "colour": "orange", "code": "    n = 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "72", "colour": "orange", "code": "    for x in iterable:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "73", "colour": "orange", "code": "        n += x\n", "error": "none", "author": "tom@organisms.be"}, {"index": "74", "colour": "orange", "code": "        yield n\n", "error": "none", "author": "tom@organisms.be"}, {"index": "75", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "76", "colour": "orange", "code": "#### PROFILER ######################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "77", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "78", "colour": "orange", "code": "def duration(function, *args, **kwargs):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "79", "colour": "orange", "code": "    \"\"\" Returns the running time of the given function, in seconds.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "80", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "81", "colour": "orange", "code": "    t = time()\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "82", "colour": "orange", "code": "    function(*args, **kwargs)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "83", "colour": "orange", "code": "    return time() - t\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "84", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "85", "colour": "orange", "code": "def profile(function, *args, **kwargs):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "86", "colour": "orange", "code": "    \"\"\" Returns the performance analysis (as a string) of the given Python function.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "87", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "88", "colour": "orange", "code": "    def run():\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "89", "colour": "green", "code": "        function(*args, **kwargs)\n", "error": "W", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "90", "colour": "orange", "code": "    if not hasattr(function, \"__call__\"):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "91", "colour": "orange", "code": "        raise TypeError(\"%s is not a function\" % type(function))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "92", "colour": "orange", "code": "    try:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "93", "colour": "green", "code": "        import cProfile as profile\n", "error": "W", "author": "tom@organisms.be"}, {"index": "94", "colour": "green", "code": "    except:\n", "error": "W", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "95", "colour": "orange", "code": "        import profile\n", "error": "none", "author": "tom@organisms.be"}, {"index": "96", "colour": "orange", "code": "    import pstats\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "97", "colour": "orange", "code": "    import os\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "98", "colour": "green", "code": "    import sys; sys.modules[\"__main__\"].__profile_run__ = run\n", "error": "W", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "99", "colour": "green", "code": "    id = function.__name__ + \"()\"\n", "error": "W", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "100", "colour": "orange", "code": "    profile.run(\"__profile_run__()\", id)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "101", "colour": "orange", "code": "    p = pstats.Stats(id)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "102", "colour": "orange", "code": "    p.stream = open(id, \"w\")\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "103", "colour": "orange", "code": "    p.sort_stats(\"cumulative\").print_stats(30)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "104", "colour": "orange", "code": "    p.stream.close()\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "105", "colour": "orange", "code": "    s = open(id).read()\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "106", "colour": "orange", "code": "    os.remove(id)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "107", "colour": "orange", "code": "    return s\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "108", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "109", "colour": "green", "code": "def sizeof(object):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "110", "colour": "orange", "code": "    \"\"\" Returns the memory size of the given object (in bytes).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "111", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "112", "colour": "orange", "code": "    return sys.getsizeof(object)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "113", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "114", "colour": "green", "code": "def kb(object):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "115", "colour": "orange", "code": "    \"\"\" Returns the memory size of the given object (in kilobytes).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "116", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "117", "colour": "orange", "code": "    return sys.getsizeof(object) * 0.01\n", "error": "none", "author": "tom@organisms.be"}, {"index": "118", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "119", "colour": "orange", "code": "#### PRECISION & RECALL ############################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "120", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "121", "colour": "orange", "code": "ACCURACY, PRECISION, RECALL, F1_SCORE = \"accuracy\", \"precision\", \"recall\", \"F1-score\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "122", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "123", "colour": "orange", "code": "MACRO = \"macro\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "124", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "125", "colour": "green", "code": "def confusion_matrix(classify=lambda document: False, documents=[(None,False)]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "126", "colour": "orange", "code": "    \"\"\" Returns the performance of a binary classification task (i.e., predicts True or False)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "127", "colour": "orange", "code": "        as a tuple of (TP, TN, FP, FN):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "128", "colour": "orange", "code": "        - TP: true positives  = correct hits, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "129", "colour": "orange", "code": "        - TN: true negatives  = correct rejections,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "130", "colour": "orange", "code": "        - FP: false positives = false alarm (= type I error), \n", "error": "none", "author": "tom@organisms.be"}, {"index": "131", "colour": "orange", "code": "        - FN: false negatives = misses (= type II error).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "132", "colour": "orange", "code": "        The given classify() function returns True or False for a document.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "133", "colour": "orange", "code": "        The list of documents contains (document, bool)-tuples for testing,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "134", "colour": "orange", "code": "        where True means a document that should be identified as True by classify().\n", "error": "none", "author": "tom@organisms.be"}, {"index": "135", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "136", "colour": "orange", "code": "    TN = TP = FN = FP = 0\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "137", "colour": "orange", "code": "    for document, b1 in documents:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "138", "colour": "orange", "code": "        b2 = classify(document)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "139", "colour": "orange", "code": "        if b1 and b2:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "140", "colour": "orange", "code": "            TP += 1 # true positive\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "141", "colour": "orange", "code": "        elif not b1 and not b2:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "142", "colour": "orange", "code": "            TN += 1 # true negative\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "143", "colour": "orange", "code": "        elif not b1 and b2:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "144", "colour": "orange", "code": "            FP += 1 # false positive (type I error)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "145", "colour": "orange", "code": "        elif b1 and not b2:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "146", "colour": "orange", "code": "            FN += 1 # false negative (type II error)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "147", "colour": "orange", "code": "    return TP, TN, FP, FN\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "148", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "149", "colour": "green", "code": "def test(classify=lambda document:False, documents=[], average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "150", "colour": "orange", "code": "    \"\"\" Returns an (accuracy, precision, recall, F1-score)-tuple.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "151", "colour": "orange", "code": "        With average=None, precision & recall are computed for the positive class (True).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "152", "colour": "orange", "code": "        With average=MACRO, precision & recall for positive and negative class are macro-averaged.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "153", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "154", "colour": "orange", "code": "    TP, TN, FP, FN = confusion_matrix(classify, documents)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "155", "colour": "orange", "code": "    A  = float(TP + TN) / ((TP + TN + FP + FN) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "156", "colour": "orange", "code": "    P1 = float(TP) / ((TP + FP) or 1) # positive class precision\n", "error": "none", "author": "tom@organisms.be"}, {"index": "157", "colour": "orange", "code": "    R1 = float(TP) / ((TP + FN) or 1) # positive class recall\n", "error": "none", "author": "tom@organisms.be"}, {"index": "158", "colour": "orange", "code": "    P0 = float(TN) / ((TN + FN) or 1) # negative class precision\n", "error": "none", "author": "tom@organisms.be"}, {"index": "159", "colour": "orange", "code": "    R0 = float(TN) / ((TN + FP) or 1) # negative class recall\n", "error": "none", "author": "tom@organisms.be"}, {"index": "160", "colour": "orange", "code": "    if average is None:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "161", "colour": "orange", "code": "        P, R = (P1, R1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "162", "colour": "orange", "code": "    if average == MACRO:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "163", "colour": "orange", "code": "        P, R = ((P1 + P0) / 2,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "164", "colour": "orange", "code": "                (R1 + R0) / 2)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "165", "colour": "green", "code": "    F1 = 2 * P * R / ((P + R) or 1)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "166", "colour": "orange", "code": "    return (A, P, R, F1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "167", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "168", "colour": "green", "code": "def accuracy(classify=lambda document:False, documents=[], average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "169", "colour": "orange", "code": "    \"\"\" Returns the percentage of correct classifications (true positives + true negatives).\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "170", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "171", "colour": "orange", "code": "    return test(classify, documents, average)[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "172", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "173", "colour": "green", "code": "def precision(classify=lambda document:False, documents=[], average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "174", "colour": "orange", "code": "    \"\"\" Returns the percentage of correct positive classifications.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "175", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "176", "colour": "orange", "code": "    return test(classify, documents, average)[1]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "177", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "178", "colour": "green", "code": "def recall(classify=lambda document:False, documents=[], average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "179", "colour": "orange", "code": "    \"\"\" Returns the percentage of positive cases correctly classified as positive.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "180", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "181", "colour": "orange", "code": "    return test(classify, documents, average)[2]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "182", "colour": "orange", "code": "    \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "183", "colour": "green", "code": "def F1(classify=lambda document:False, documents=[], average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "184", "colour": "orange", "code": "    \"\"\" Returns the harmonic mean of precision and recall.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "185", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "186", "colour": "orange", "code": "    return test(classify, documents, average)[3]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "187", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "188", "colour": "green", "code": "def F(classify=lambda document:False, documents=[], beta=1, average=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "189", "colour": "orange", "code": "    \"\"\" Returns the weighted harmonic mean of precision and recall,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "190", "colour": "orange", "code": "        where recall is beta times more important than precision.\n", "error": "none", "author": "peteris.erins@gmail.com"}, {"index": "191", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "peteris.erins@gmail.com"}, {"index": "192", "colour": "green", "code": "    A, P, R, F1 = test(classify, documents, average)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "193", "colour": "orange", "code": "    return (beta ** 2 + 1) * P * R / ((beta ** 2 * P + R) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "194", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "195", "colour": "orange", "code": "#### SENSITIVITY & SPECIFICITY #####################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "196", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "197", "colour": "green", "code": "def sensitivity(classify=lambda document:False, documents=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "198", "colour": "orange", "code": "    \"\"\" Returns the percentage of positive cases correctly classified as positive (= recall).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "199", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "200", "colour": "red", "code": "    return recall(classify, document, average=None)\n", "error": "E", "author": "tom@organisms.be"}, {"index": "201", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "202", "colour": "green", "code": "def specificity(classify=lambda document:False, documents=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "203", "colour": "orange", "code": "    \"\"\" Returns the percentage of negative cases correctly classified as negative.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "204", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "205", "colour": "green", "code": "    TP, TN, FP, FN = confusion_matrix(classify, documents)\n", "error": "W", "author": "epdmitry@yandex.ru"}, {"index": "206", "colour": "orange", "code": "    return float(TN) / ((TN + FP) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "207", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "208", "colour": "orange", "code": "TPR = sensitivity # true positive rate\n", "error": "none", "author": "tom@organisms.be"}, {"index": "209", "colour": "orange", "code": "TNR = specificity # true negative rate\n", "error": "none", "author": "tom@organisms.be"}, {"index": "210", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "211", "colour": "orange", "code": "#### ROC & AUC #####################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "212", "colour": "orange", "code": "# See: Tom Fawcett (2005), An Introduction to ROC analysis.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "213", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "214", "colour": "green", "code": "def roc(tests=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "215", "colour": "orange", "code": "    \"\"\" Returns the ROC curve as an iterator of (x, y)-points,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "216", "colour": "orange", "code": "        for the given list of (TP, TN, FP, FN)-tuples.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "217", "colour": "orange", "code": "        The x-axis represents FPR = the false positive rate (1 - specificity).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "218", "colour": "orange", "code": "        The y-axis represents TPR = the true positive rate.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "219", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "220", "colour": "green", "code": "    x = FPR = lambda TP, TN, FP, FN: float(FP) / ((FP + TN) or 1)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "221", "colour": "green", "code": "    y = TPR = lambda TP, TN, FP, FN: float(TP) / ((TP + FN) or 1)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "222", "colour": "green", "code": "    return sorted([(0.0, 0.0), (1.0, 1.0)] + [(x(*m), y(*m)) for m in tests])\n", "error": "W", "author": "tom@organisms.be"}, {"index": "223", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "224", "colour": "green", "code": "def auc(curve=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "225", "colour": "orange", "code": "    \"\"\" Returns the area under the curve for the given list of (x, y)-points.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "226", "colour": "orange", "code": "        The area is calculated using the trapezoidal rule.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "227", "colour": "orange", "code": "        For the area under the ROC-curve, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "228", "colour": "orange", "code": "        the return value is the probability (0.0-1.0) that a classifier will rank \n", "error": "none", "author": "tom@organisms.be"}, {"index": "229", "colour": "orange", "code": "        a random positive document (True) higher than a random negative one (False).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "230", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "231", "colour": "orange", "code": "    curve = sorted(curve)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "232", "colour": "orange", "code": "    # Trapzoidal rule: area = (a + b) * h / 2, where a=y0, b=y1 and h=x1-x0.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "233", "colour": "orange", "code": "    return sum(0.5 * (x1 - x0) * (y1 + y0) for (x0, y0), (x1, y1) in sorted(zip(curve, curve[1:])))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "234", "colour": "orange", "code": "\n", "error": "none", "author": "peteris.erins@gmail.com"}, {"index": "235", "colour": "orange", "code": "#### AGREEMENT #####################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "236", "colour": "orange", "code": "# +1.0 = total agreement between voters\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "237", "colour": "orange", "code": "# +0.0 = votes based on random chance\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "238", "colour": "orange", "code": "# -1.0 = total disagreement\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "239", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "240", "colour": "orange", "code": "def fleiss_kappa(m):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "241", "colour": "orange", "code": "    \"\"\" Returns the reliability of agreement as a number between -1.0 and +1.0,\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "242", "colour": "orange", "code": "        for a number of votes per category per task.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "243", "colour": "orange", "code": "        The given m is a list in which each row represents a task.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "244", "colour": "orange", "code": "        Each task is a list with the number of votes per category.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "245", "colour": "orange", "code": "        Each column represents a category.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "246", "colour": "orange", "code": "        For example, say 5 people are asked to vote \"cat\" and \"dog\" as \"good\" or \"bad\":\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "247", "colour": "orange", "code": "         m = [# + -        \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "248", "colour": "orange", "code": "               [3,2], # cat\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "249", "colour": "orange", "code": "               [5,0]] # dog\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "250", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "251", "colour": "orange", "code": "    N = len(m)    # Total number of tasks.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "252", "colour": "orange", "code": "    n = sum(m[0]) # The number of votes per task.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "253", "colour": "orange", "code": "    k = len(m[0]) # The number of categories.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "254", "colour": "orange", "code": "    if n == 1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "255", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "256", "colour": "orange", "code": "    assert all(sum(row) == n for row in m[1:]), \"numer of votes for each task differs\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "257", "colour": "orange", "code": "    # p[j] = the proportion of all assignments which were to the j-th category.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "258", "colour": "orange", "code": "    p = [sum(m[i][j] for i in xrange(N)) / float(N*n) for j in xrange(k)]\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "259", "colour": "orange", "code": "    # P[i] = the extent to which voters agree for the i-th subject.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "260", "colour": "orange", "code": "    P = [(sum(m[i][j]**2 for j in xrange(k)) - n) / float(n * (n-1)) for i in xrange(N)]\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "261", "colour": "orange", "code": "    # Pm = the mean of P[i] and Pe.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "262", "colour": "orange", "code": "    Pe = sum(pj**2 for pj in p)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "263", "colour": "orange", "code": "    Pm = sum(P) / N\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "264", "colour": "orange", "code": "    K = (Pm - Pe) / ((1 - Pe) or 1) # kappa\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "265", "colour": "orange", "code": "    return K\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "266", "colour": "orange", "code": "    \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "267", "colour": "orange", "code": "agreement = fleiss_kappa\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "268", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "269", "colour": "orange", "code": "#### TEXT METRICS ##################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "270", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "271", "colour": "orange", "code": "#--- SIMILARITY ------------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "272", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "273", "colour": "orange", "code": "def levenshtein(string1, string2):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "274", "colour": "orange", "code": "    \"\"\" Measures the amount of difference between two strings.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "275", "colour": "orange", "code": "        The return value is the number of operations (insert, delete, replace)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "276", "colour": "orange", "code": "        required to transform string a into string b.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "277", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "278", "colour": "orange", "code": "    # http://hetland.org/coding/python/levenshtein.py\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "279", "colour": "orange", "code": "    n, m = len(string1), len(string2)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "280", "colour": "orange", "code": "    if n > m: \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "281", "colour": "orange", "code": "        # Make sure n <= m to use O(min(n,m)) space.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "282", "colour": "orange", "code": "        string1, string2, n, m = string2, string1, m, n\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "283", "colour": "orange", "code": "    current = range(n+1)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "284", "colour": "orange", "code": "    for i in xrange(1, m+1):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "285", "colour": "orange", "code": "        previous, current = current, [i]+[0]*n\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "286", "colour": "orange", "code": "        for j in xrange(1, n+1):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "287", "colour": "orange", "code": "            insert, delete, replace = previous[j]+1, current[j-1]+1, previous[j-1]\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "288", "colour": "orange", "code": "            if string1[j-1] != string2[i-1]:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "289", "colour": "orange", "code": "                replace += 1\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "290", "colour": "orange", "code": "            current[j] = min(insert, delete, replace)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "291", "colour": "orange", "code": "    return current[n]\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "292", "colour": "orange", "code": "    \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "293", "colour": "orange", "code": "edit_distance = levenshtein\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "294", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "295", "colour": "orange", "code": "def levenshtein_similarity(string1, string2):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "296", "colour": "orange", "code": "    \"\"\" Returns the similarity of string1 and string2 as a number between 0.0 and 1.0.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "297", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "298", "colour": "orange", "code": "    return 1 - levenshtein(string1, string2) / float(max(len(string1),  len(string2), 1.0))\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "299", "colour": "orange", "code": "    \n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "300", "colour": "orange", "code": "def dice_coefficient(string1, string2):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "301", "colour": "orange", "code": "    \"\"\" Returns the similarity between string1 and string1 as a number between 0.0 and 1.0,\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "302", "colour": "orange", "code": "        based on the number of shared bigrams, e.g., \"night\" and \"nacht\" have one common bigram \"ht\".\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "303", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "304", "colour": "orange", "code": "    def bigrams(s):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "305", "colour": "orange", "code": "        return set(s[i:i+2] for i in xrange(len(s)-1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "306", "colour": "orange", "code": "    nx = bigrams(string1)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "307", "colour": "orange", "code": "    ny = bigrams(string2)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "308", "colour": "orange", "code": "    nt = nx.intersection(ny)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "309", "colour": "orange", "code": "    return 2.0 * len(nt) / ((len(nx) + len(ny)) or 1)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "310", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "311", "colour": "orange", "code": "LEVENSHTEIN, DICE = \"levenshtein\", \"dice\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "312", "colour": "orange", "code": "def similarity(string1, string2, metric=LEVENSHTEIN):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "313", "colour": "orange", "code": "    \"\"\" Returns the similarity of string1 and string2 as a number between 0.0 and 1.0,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "314", "colour": "orange", "code": "        using LEVENSHTEIN edit distance or DICE coefficient.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "315", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "316", "colour": "orange", "code": "    if metric == LEVENSHTEIN:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "317", "colour": "orange", "code": "        return levenshtein_similarity(string1, string2)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "318", "colour": "orange", "code": "    if metric == DICE:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "319", "colour": "orange", "code": "        return dice_coefficient(string1, string2)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "320", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "321", "colour": "orange", "code": "#--- READABILITY -----------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "322", "colour": "orange", "code": "# 0.9-1.0 = easily understandable by 11-year old.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "323", "colour": "orange", "code": "# 0.6-0.7 = easily understandable by 13- to 15-year old.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "324", "colour": "orange", "code": "# 0.0-0.3 = best understood by university graduates.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "325", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "326", "colour": "orange", "code": "def flesch_reading_ease(string):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "327", "colour": "orange", "code": "    \"\"\" Returns the readability of the string as a value between 0.0-1.0:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "328", "colour": "orange", "code": "        0.30-0.50 (difficult) => 0.60-0.70 (standard) => 0.90-1.00 (very easy).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "329", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "330", "colour": "orange", "code": "    def count_syllables(word, vowels=\"aeiouy\"):\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "331", "colour": "orange", "code": "        n = 0\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "332", "colour": "orange", "code": "        p = False # True if the previous character was a vowel.\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "333", "colour": "orange", "code": "        for ch in word.endswith(\"e\") and word[:-1] or word:\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "334", "colour": "orange", "code": "            v = ch in vowels\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "335", "colour": "orange", "code": "            n += int(v and not p)\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "336", "colour": "orange", "code": "            p = v\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "337", "colour": "orange", "code": "        return n\n", "error": "none", "author": "tom@organisms.be"}, {"index": "338", "colour": "orange", "code": "    if not isinstance(string, basestring):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "339", "colour": "orange", "code": "        raise TypeError(\"%s is not a string\" % repr(string))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "340", "colour": "orange", "code": "    if len(string) <  3:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "341", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "342", "colour": "orange", "code": "    if len(string.split(\" \")) < 2:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "343", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "344", "colour": "orange", "code": "    string = string.strip()\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "345", "colour": "orange", "code": "    string = string.strip(\"\\\"'().\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "346", "colour": "orange", "code": "    string = string.lower()\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "347", "colour": "orange", "code": "    string = string.replace(\"!\", \".\")\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "348", "colour": "orange", "code": "    string = string.replace(\"?\", \".\")\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "349", "colour": "orange", "code": "    string = string.replace(\",\", \" \")\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "350", "colour": "orange", "code": "    string = \" \".join(string.split())\n", "error": "none", "author": "tom@organisms.be"}, {"index": "351", "colour": "orange", "code": "    y = [count_syllables(w) for w in string.split() if w != \"\"]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "352", "colour": "green", "code": "    w = max(1, len([w for w in string.split(\" \") if w != \"\"]))\n", "error": "W", "author": "tom@organisms.be"}, {"index": "353", "colour": "orange", "code": "    s = max(1, len([s for s in string.split(\".\") if len(s) > 2]))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "354", "colour": "orange", "code": "    #R = 206.835 - 1.015 * w/s - 84.6 * sum(y)/w\n", "error": "none", "author": "tom@organisms.be"}, {"index": "355", "colour": "orange", "code": "    # Use the Farr, Jenkins & Patterson algorithm,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "356", "colour": "orange", "code": "    # which uses simpler syllable counting (count_syllables() is the weak point here). \n", "error": "none", "author": "tom@organisms.be"}, {"index": "357", "colour": "orange", "code": "    R = 1.599 * sum(1 for v in y if v == 1) * 100 / w - 1.015 * w / s - 31.517\n", "error": "none", "author": "tom@organisms.be"}, {"index": "358", "colour": "orange", "code": "    R = max(0.0, min(R * 0.01, 1.0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "359", "colour": "orange", "code": "    return R\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "360", "colour": "orange", "code": "\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "361", "colour": "orange", "code": "readability = flesch_reading_ease\n", "error": "none", "author": "tomdesmedt@gmail.com@b69ec992-5447-3b6c-d919-7ed00d13665f"}, {"index": "362", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "363", "colour": "orange", "code": "#--- INTERTEXTUALITY -------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "364", "colour": "orange", "code": "# Intertextuality may be useful for plagiarism detection.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "365", "colour": "orange", "code": "# For example, on the Corpus of Plagiarised Short Answers (Clough & Stevenson, 2009),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "366", "colour": "orange", "code": "# accuracy (F1) is 94.5% with n=3 and intertextuality threshold > 0.1.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "367", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "368", "colour": "orange", "code": "PUNCTUATION = \".,;:!?()[]{}`'\\\"@#$^&*+-|=~_\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "369", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "370", "colour": "green", "code": "def ngrams(string, n=3, punctuation=PUNCTUATION, **kwargs):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "371", "colour": "orange", "code": "    \"\"\" Returns a list of n-grams (tuples of n successive words) from the given string.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "372", "colour": "orange", "code": "        Punctuation marks are stripped from words.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "373", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "374", "colour": "orange", "code": "    s = string\n", "error": "none", "author": "tom@organisms.be"}, {"index": "375", "colour": "orange", "code": "    s = s.replace(\".\", \" .\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "376", "colour": "orange", "code": "    s = s.replace(\"?\", \" ?\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "377", "colour": "orange", "code": "    s = s.replace(\"!\", \" !\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "378", "colour": "orange", "code": "    s = [w.strip(punctuation) for w in s.split()]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "379", "colour": "orange", "code": "    s = [w.strip() for w in s if w.strip()]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "380", "colour": "orange", "code": "    return [tuple(s[i:i+n]) for i in xrange(len(s) - n + 1)]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "381", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "382", "colour": "orange", "code": "class Weight(float):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "383", "colour": "orange", "code": "    \"\"\" A float with a magic \"assessments\" property,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "384", "colour": "orange", "code": "        which is the set of all n-grams contributing to the weight.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "385", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "386", "colour": "green", "code": "    def __new__(self, value=0.0, assessments=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "387", "colour": "orange", "code": "        return float.__new__(self, value)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "388", "colour": "green", "code": "    def __init__(self, value=0.0, assessments=[]):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "389", "colour": "orange", "code": "        self.assessments = set(assessments)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "390", "colour": "orange", "code": "    def __iadd__(self, value):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "391", "colour": "orange", "code": "        return Weight(self + value, self.assessments)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "392", "colour": "orange", "code": "    def __isub__(self, value):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "393", "colour": "orange", "code": "        return Weight(self - value, self.assessments)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "394", "colour": "orange", "code": "    def __imul__(self, value):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "395", "colour": "orange", "code": "        return Weight(self * value, self.assessments)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "396", "colour": "orange", "code": "    def __idiv__(self, value):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "397", "colour": "orange", "code": "        return Weight(self / value, self.assessments)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "398", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "399", "colour": "green", "code": "def intertextuality(texts=[], n=5, weight=lambda ngram: 1.0, **kwargs):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "400", "colour": "orange", "code": "    \"\"\" Returns a dictionary of (i, j) => float.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "401", "colour": "orange", "code": "        For indices i and j in the given list of texts,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "402", "colour": "orange", "code": "        the corresponding float is the percentage of text i that is also in text j.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "403", "colour": "orange", "code": "        Overlap is measured by matching n-grams (by default, 5 successive words).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "404", "colour": "orange", "code": "        An optional weight function can be used to supply the weight of each n-gram.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "405", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "406", "colour": "green", "code": "    map = {} # n-gram => text id's\n", "error": "W", "author": "tom@organisms.be"}, {"index": "407", "colour": "green", "code": "    sum = {} # text id => sum of weight(n-gram)\n", "error": "W", "author": "tom@organisms.be"}, {"index": "408", "colour": "orange", "code": "    for i, txt in enumerate(texts):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "409", "colour": "orange", "code": "        for j, ngram in enumerate(ngrams(txt, n, **kwargs)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "410", "colour": "orange", "code": "            if ngram not in map:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "411", "colour": "orange", "code": "                map[ngram] = set()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "412", "colour": "orange", "code": "            map[ngram].add(i)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "413", "colour": "orange", "code": "            sum[i] = sum.get(i, 0) + weight(ngram)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "414", "colour": "orange", "code": "    w = defaultdict(Weight) # (id1, id2) => percentage of id1 that overlaps with id2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "415", "colour": "orange", "code": "    for ngram in map:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "416", "colour": "orange", "code": "        for i in map[ngram]:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "417", "colour": "orange", "code": "            for j in map[ngram]:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "418", "colour": "orange", "code": "                if i != j:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "419", "colour": "orange", "code": "                    if (i,j) not in w:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "420", "colour": "orange", "code": "                        w[i,j] = Weight(0.0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "421", "colour": "orange", "code": "                    w[i,j] += weight(ngram)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "422", "colour": "orange", "code": "                    w[i,j].assessments.add(ngram)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "423", "colour": "orange", "code": "    for i, j in w:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "424", "colour": "orange", "code": "        w[i,j] /= float(sum[i])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "425", "colour": "orange", "code": "        w[i,j]  = min(w[i,j], Weight(1.0))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "426", "colour": "orange", "code": "    return w\n", "error": "none", "author": "tom@organisms.be"}, {"index": "427", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "428", "colour": "orange", "code": "#--- WORD TYPE-TOKEN RATIO -------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "429", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "430", "colour": "orange", "code": "def type_token_ratio(string, n=100, punctuation=PUNCTUATION):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "431", "colour": "orange", "code": "    \"\"\" Returns the percentage of unique words in the given string as a number between 0.0-1.0,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "432", "colour": "orange", "code": "        as opposed to the total number of words (= lexical diversity, vocabulary richness).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "433", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "434", "colour": "orange", "code": "    def window(a, n=100):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "435", "colour": "orange", "code": "        if n > 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "436", "colour": "orange", "code": "            for i in xrange(max(len(a) - n + 1, 1)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "437", "colour": "orange", "code": "                yield a[i:i+n]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "438", "colour": "orange", "code": "    s = string.lower().split()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "439", "colour": "orange", "code": "    s = [w.strip(punctuation) for w in s]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "440", "colour": "orange", "code": "    # Covington & McFall moving average TTR algorithm.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "441", "colour": "orange", "code": "    return mean(1.0 * len(set(x)) / len(x) for x in window(s, n))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "442", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "443", "colour": "orange", "code": "ttr = type_token_ratio\n", "error": "none", "author": "tom@organisms.be"}, {"index": "444", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "445", "colour": "orange", "code": "#--- WORD INFLECTION -------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "446", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "447", "colour": "green", "code": "def suffixes(inflections=[], n=3, top=10, reverse=True):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "448", "colour": "orange", "code": "    \"\"\" For a given list of (base, inflection)-tuples,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "449", "colour": "orange", "code": "        returns a list of (count, inflected suffix, [(base suffix, frequency), ... ]):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "450", "colour": "orange", "code": "        suffixes([(\"beau\", \"beaux\"), (\"jeune\", \"jeunes\"), (\"hautain\", \"hautaines\")], n=3) =>\n", "error": "none", "author": "tom@organisms.be"}, {"index": "451", "colour": "orange", "code": "        [(2, \"nes\", [(\"ne\", 0.5), (\"n\", 0.5)]), (1, \"aux\", [(\"au\", 1.0)])]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "452", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "453", "colour": "orange", "code": "    # This is utility function we use to train singularize() and lemma()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "454", "colour": "orange", "code": "    # in pattern.de, pattern.es, pattern.fr, etc.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "455", "colour": "orange", "code": "    d = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "456", "colour": "orange", "code": "    for x, y in (reverse and (y, x) or (x, y) for x, y in inflections):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "457", "colour": "orange", "code": "        x0 = x[:-n]      # be-   jeu-  hautai-\n", "error": "none", "author": "tom@organisms.be"}, {"index": "458", "colour": "orange", "code": "        x1 = x[-n:]      # -aux  -nes  -nes\n", "error": "none", "author": "tom@organisms.be"}, {"index": "459", "colour": "orange", "code": "        y1 = y[len(x0):] # -au   -ne   -n\n", "error": "none", "author": "tom@organisms.be"}, {"index": "460", "colour": "orange", "code": "        if x0 + y1 != y:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "461", "colour": "orange", "code": "            continue\n", "error": "none", "author": "tom@organisms.be"}, {"index": "462", "colour": "orange", "code": "        if x1 not in d:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "463", "colour": "orange", "code": "            d[x1] = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "464", "colour": "orange", "code": "        if y1 not in d[x1]:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "465", "colour": "orange", "code": "            d[x1][y1] = 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "466", "colour": "orange", "code": "        d[x1][y1] += 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "467", "colour": "orange", "code": "    # Sort by frequency of inflected suffix: 2x -nes, 1x -aux.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "468", "colour": "orange", "code": "    # Sort by frequency of base suffixes for each inflection:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "469", "colour": "orange", "code": "    # [(2, \"nes\", [(\"ne\", 0.5), (\"n\", 0.5)]), (1, \"aux\", [(\"au\", 1.0)])]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "470", "colour": "orange", "code": "    d = [(int(sum(y.values())), x, y.items()) for x, y in d.items()]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "471", "colour": "orange", "code": "    d = sorted(d, reverse=True)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "472", "colour": "orange", "code": "    d = ((n, x, (sorted(y, key=itemgetter(1)))) for n, x, y in d)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "473", "colour": "orange", "code": "    d = ((n, x, [(y, m / n) for y, m in y]) for n, x, y in d)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "474", "colour": "orange", "code": "    return list(d)[:top]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "475", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "476", "colour": "orange", "code": "#--- WORD CO-OCCURRENCE ----------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "477", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "478", "colour": "blue", "code": "class Sentinel(object):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "479", "colour": "orange", "code": "    pass\n", "error": "none", "author": "tom@organisms.be"}, {"index": "480", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "481", "colour": "orange", "code": "def isplit(string, sep=\"\\t\\n\\x0b\\x0c\\r \"):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "482", "colour": "orange", "code": "    \"\"\" Returns an iterator over string.split().\n", "error": "none", "author": "tom@organisms.be"}, {"index": "483", "colour": "orange", "code": "        This is efficient in combination with cooccurrence(), \n", "error": "none", "author": "tom@organisms.be"}, {"index": "484", "colour": "orange", "code": "        since the string may be very long (e.g., Brown corpus).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "485", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "486", "colour": "orange", "code": "    a = []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "487", "colour": "orange", "code": "    for ch in string:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "488", "colour": "orange", "code": "        if ch not in sep: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "489", "colour": "orange", "code": "            a.append(ch)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "490", "colour": "orange", "code": "            continue\n", "error": "none", "author": "tom@organisms.be"}, {"index": "491", "colour": "orange", "code": "        if a: yield \"\".join(a); a=[]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "492", "colour": "orange", "code": "    if a: yield \"\".join(a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "493", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "494", "colour": "blue", "code": "def cooccurrence(iterable, window=(-1,-1), term1=lambda x: True, term2=lambda x: True, normalize=lambda x: x, matrix=None, update=None):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "495", "colour": "orange", "code": "    \"\"\" Returns the co-occurence matrix of terms in the given iterable, string, file or file list,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "496", "colour": "orange", "code": "        as a dictionary: {term1: {term2: count, term3: count, ...}}.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "497", "colour": "orange", "code": "        The window specifies the size of the co-occurence window.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "498", "colour": "orange", "code": "        The term1() function defines anchors.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "499", "colour": "orange", "code": "        The term2() function defines co-occurring terms to count.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "500", "colour": "orange", "code": "        The normalize() function can be used to remove punctuation, lowercase words, etc.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "501", "colour": "orange", "code": "        Optionally, a user-defined matrix to update can be given.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "502", "colour": "orange", "code": "        Optionally, a user-defined update(matrix, term1, term2, index2) function can be given.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "503", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "504", "colour": "orange", "code": "    if not isinstance(matrix, dict):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "505", "colour": "orange", "code": "        matrix = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "506", "colour": "orange", "code": "    # Memory-efficient iteration:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "507", "colour": "orange", "code": "    if isinstance(iterable, basestring):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "508", "colour": "orange", "code": "        iterable = isplit(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "509", "colour": "orange", "code": "    if isinstance(iterable, (list, tuple)) and all(hasattr(f, \"read\") for f in iterable):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "510", "colour": "green", "code": "        iterable = chain(*(isplit(chain(*x)) for x in iterable))\n", "error": "W", "author": "tom@organisms.be"}, {"index": "511", "colour": "orange", "code": "    if hasattr(iterable, \"read\"):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "512", "colour": "green", "code": "        iterable = isplit(chain(*iterable))\n", "error": "W", "author": "tom@organisms.be"}, {"index": "513", "colour": "orange", "code": "    # Window of terms before and after the search term.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "514", "colour": "orange", "code": "    # Deque is more efficient than list.pop(0).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "515", "colour": "orange", "code": "    q = deque()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "516", "colour": "orange", "code": "    # Window size of terms alongside the search term.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "517", "colour": "orange", "code": "    # Note that window=(0,0) will return a dictionary of search term frequency\n", "error": "none", "author": "tom@organisms.be"}, {"index": "518", "colour": "orange", "code": "    # (since it counts co-occurence with itself).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "519", "colour": "orange", "code": "    n = -min(0, window[0]) + max(window[1], 0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "520", "colour": "orange", "code": "    m = matrix\n", "error": "none", "author": "tom@organisms.be"}, {"index": "521", "colour": "orange", "code": "    # Search terms may fall outside the co-occurrence window, e.g., window=(-3,-2).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "522", "colour": "orange", "code": "    # We add sentinel markers at the start and end of the given iterable.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "523", "colour": "orange", "code": "    for x in chain([Sentinel()] * n, iterable, [Sentinel()] * n):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "524", "colour": "orange", "code": "        q.append(x)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "525", "colour": "orange", "code": "        if len(q) > n:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "526", "colour": "orange", "code": "            # Given window q size and offset,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "527", "colour": "orange", "code": "            # find the index of the candidate term:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "528", "colour": "orange", "code": "            if window[1] >= 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "529", "colour": "orange", "code": "                i = -1 - window[1]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "530", "colour": "orange", "code": "            if window[1] < 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "531", "colour": "orange", "code": "                i = len(q) - 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "532", "colour": "orange", "code": "            if i < 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "533", "colour": "orange", "code": "                i = len(q) + i\n", "error": "none", "author": "tom@organisms.be"}, {"index": "534", "colour": "orange", "code": "            x1 = q[i]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "535", "colour": "orange", "code": "            if not isinstance(x1, Sentinel):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "536", "colour": "orange", "code": "                x1 = normalize(x1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "537", "colour": "orange", "code": "                if term1(x1):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "538", "colour": "orange", "code": "                    # Iterate the window and filter co-occurent terms.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "539", "colour": "green", "code": "                    for j, x2 in enumerate(list(q).__getslice__(i+window[0], i+window[1]+1)):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "540", "colour": "orange", "code": "                        if not isinstance(x2, Sentinel):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "541", "colour": "orange", "code": "                            x2 = normalize(x2)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "542", "colour": "orange", "code": "                            if term2(x2):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "543", "colour": "orange", "code": "                                if update:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "544", "colour": "orange", "code": "                                    update(matrix, x1, x2, j); continue\n", "error": "none", "author": "tom@organisms.be"}, {"index": "545", "colour": "orange", "code": "                                if x1 not in m:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "546", "colour": "orange", "code": "                                    m[x1] = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "547", "colour": "orange", "code": "                                if x2 not in m[x1]:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "548", "colour": "orange", "code": "                                    m[x1][x2] = 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "549", "colour": "orange", "code": "                                m[x1][x2] += 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "550", "colour": "orange", "code": "            # Slide window.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "551", "colour": "orange", "code": "            q.popleft()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "552", "colour": "orange", "code": "    return m\n", "error": "none", "author": "tom@organisms.be"}, {"index": "553", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "554", "colour": "orange", "code": "co_occurrence = cooccurrence\n", "error": "none", "author": "tom@organisms.be"}, {"index": "555", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "556", "colour": "orange", "code": "## Words occuring before and after the word \"cat\":\n", "error": "none", "author": "tom@organisms.be"}, {"index": "557", "colour": "orange", "code": "## {\"cat\": {\"sat\": 1, \"black\": 1, \"cat\": 1}}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "558", "colour": "orange", "code": "#s = \"The black cat sat on the mat.\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "559", "colour": "orange", "code": "#print(cooccurrence(s, window=(-1,1), \n", "error": "none", "author": "tom@organisms.be"}, {"index": "560", "colour": "orange", "code": "#       search = lambda w: w in (\"cat\",),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "561", "colour": "orange", "code": "#    normalize = lambda w: w.lower().strip(\".:;,!?()[]'\\\"\")))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "562", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "563", "colour": "orange", "code": "## Adjectives preceding nouns:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "564", "colour": "orange", "code": "## {(\"cat\", \"NN\"): {(\"black\", \"JJ\"): 1}}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "565", "colour": "orange", "code": "#s = [(\"The\",\"DT\"), (\"black\",\"JJ\"), (\"cat\",\"NN\"), (\"sat\",\"VB\"), (\"on\",\"IN\"), (\"the\",\"DT\"), (\"mat\",\"NN\")]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "566", "colour": "orange", "code": "#print(cooccurrence(s, window=(-2,-1), \n", "error": "none", "author": "tom@organisms.be"}, {"index": "567", "colour": "orange", "code": "#       search = lambda token: token[1].startswith(\"NN\"),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "568", "colour": "orange", "code": "#       filter = lambda token: token[1].startswith(\"JJ\")))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "569", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "570", "colour": "orange", "code": "# Adjectives preceding nouns:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "571", "colour": "orange", "code": "# {(\"cat\", \"NN\"): {(\"black\", \"JJ\"): 1}}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "572", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "573", "colour": "orange", "code": "#### STATISTICS ####################################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "574", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "575", "colour": "orange", "code": "#--- MEAN ------------------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "576", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "577", "colour": "orange", "code": "def mean(iterable):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "578", "colour": "orange", "code": "    \"\"\" Returns the arithmetic mean of the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "579", "colour": "orange", "code": "        For example: mean([1,2,3,4]) = 10/4 = 2.5.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "580", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "581", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "582", "colour": "orange", "code": "    return float(sum(a)) / (len(a) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "583", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "584", "colour": "orange", "code": "avg = mean\n", "error": "none", "author": "tom@organisms.be"}, {"index": "585", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "586", "colour": "orange", "code": "def hmean(iterable):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "587", "colour": "orange", "code": "    \"\"\" Returns the harmonic mean of the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "588", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "589", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "590", "colour": "orange", "code": "    return float(len(a)) / sum(1.0 / x for x in a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "591", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "592", "colour": "orange", "code": "def median(iterable, sort=True):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "593", "colour": "orange", "code": "    \"\"\" Returns the value that separates the lower half from the higher half of values in the list.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "594", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "595", "colour": "orange", "code": "    s = sorted(iterable) if sort is True else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "596", "colour": "orange", "code": "    n = len(s)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "597", "colour": "orange", "code": "    if n == 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "598", "colour": "orange", "code": "        raise ValueError(\"median() arg is an empty sequence\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "599", "colour": "orange", "code": "    if n % 2 == 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "600", "colour": "orange", "code": "        return float(s[(n // 2) - 1] + s[n // 2]) / 2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "601", "colour": "orange", "code": "    return s[n // 2]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "602", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "603", "colour": "orange", "code": "def variance(iterable, sample=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "604", "colour": "orange", "code": "    \"\"\" Returns the variance of the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "605", "colour": "orange", "code": "        The variance is the average of squared deviations from the mean.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "606", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "607", "colour": "orange", "code": "    # Sample variance = E((xi-m)^2) / (n-1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "608", "colour": "orange", "code": "    # Population variance = E((xi-m)^2) / n\n", "error": "none", "author": "tom@organisms.be"}, {"index": "609", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "610", "colour": "orange", "code": "    m = mean(a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "611", "colour": "orange", "code": "    return sum((x - m) ** 2 for x in a) / (len(a) - int(sample) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "612", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "613", "colour": "orange", "code": "def standard_deviation(iterable, *args, **kwargs):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "614", "colour": "orange", "code": "    \"\"\" Returns the standard deviation of the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "615", "colour": "orange", "code": "        Low standard deviation => values are close to the mean.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "616", "colour": "orange", "code": "        High standard deviation => values are spread out over a large range.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "617", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "618", "colour": "orange", "code": "    return sqrt(variance(iterable, *args, **kwargs))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "619", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "620", "colour": "orange", "code": "stdev = standard_deviation\n", "error": "none", "author": "tom@organisms.be"}, {"index": "621", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "622", "colour": "orange", "code": "def simple_moving_average(iterable, k=10):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "623", "colour": "orange", "code": "    \"\"\" Returns an iterator over the simple moving average of the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "624", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "625", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "626", "colour": "orange", "code": "    for m in xrange(len(a)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "627", "colour": "orange", "code": "        i = m - k\n", "error": "none", "author": "tom@organisms.be"}, {"index": "628", "colour": "orange", "code": "        j = m + k + 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "629", "colour": "orange", "code": "        w = a[max(0,i):j]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "630", "colour": "orange", "code": "        yield float(sum(w)) / (len(w) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "631", "colour": "orange", "code": "      \n", "error": "none", "author": "tom@organisms.be"}, {"index": "632", "colour": "orange", "code": "sma = simple_moving_average\n", "error": "none", "author": "tom@organisms.be"}, {"index": "633", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "634", "colour": "green", "code": "def histogram(iterable, k=10, range=None):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "635", "colour": "orange", "code": "    \"\"\" Returns a dictionary with k items: {(start, stop): [values], ...},\n", "error": "none", "author": "tom@organisms.be"}, {"index": "636", "colour": "orange", "code": "        with equal (start, stop) intervals between min(list) => max(list).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "637", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "638", "colour": "orange", "code": "    # To loop through the intervals in sorted order, use:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "639", "colour": "orange", "code": "    # for (i, j), values in sorted(histogram(iterable).items()):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "640", "colour": "orange", "code": "    #     m = i + (j - i) / 2 # midpoint\n", "error": "none", "author": "tom@organisms.be"}, {"index": "641", "colour": "orange", "code": "    #     print(i, j, m, values)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "642", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "643", "colour": "orange", "code": "    r = range or (min(a), max(a))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "644", "colour": "orange", "code": "    k = max(int(k), 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "645", "colour": "orange", "code": "    w = float(r[1] - r[0] + 0.000001) / k # interval (bin width)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "646", "colour": "orange", "code": "    h = [[] for i in xrange(k)]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "647", "colour": "orange", "code": "    for x in a:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "648", "colour": "orange", "code": "        i = int(floor((x - r[0]) / w))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "649", "colour": "orange", "code": "        if 0 <= i < len(h): \n", "error": "none", "author": "tom@organisms.be"}, {"index": "650", "colour": "orange", "code": "            #print(x, i, \"(%.2f, %.2f)\" % (r[0] + w * i, r[0] + w + w * i))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "651", "colour": "orange", "code": "            h[i].append(x)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "652", "colour": "orange", "code": "    return dict(((r[0] + w * i, r[0] + w + w * i), v) for i, v in enumerate(h))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "653", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "654", "colour": "orange", "code": "#--- MOMENT ----------------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "655", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "656", "colour": "orange", "code": "def moment(iterable, n=2, sample=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "657", "colour": "orange", "code": "    \"\"\" Returns the n-th central moment of the given list of values\n", "error": "none", "author": "tom@organisms.be"}, {"index": "658", "colour": "orange", "code": "        (2nd central moment = variance, 3rd and 4th are used to define skewness and kurtosis).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "659", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "660", "colour": "orange", "code": "    if n == 1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "661", "colour": "orange", "code": "        return 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "662", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "663", "colour": "orange", "code": "    m = mean(a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "664", "colour": "orange", "code": "    return sum((x - m) ** n for x in a) / (len(a) - int(sample) or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "665", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "666", "colour": "orange", "code": "def skewness(iterable, sample=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "667", "colour": "orange", "code": "    \"\"\" Returns the degree of asymmetry of the given list of values:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "668", "colour": "orange", "code": "        > 0.0 => relatively few values are higher than mean(list),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "669", "colour": "orange", "code": "        < 0.0 => relatively few values are lower than mean(list),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "670", "colour": "orange", "code": "        = 0.0 => evenly distributed on both sides of the mean (= normal distribution).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "671", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "672", "colour": "orange", "code": "    # Distributions with skew and kurtosis between -1 and +1 \n", "error": "none", "author": "tom@organisms.be"}, {"index": "673", "colour": "orange", "code": "    # can be considered normal by approximation.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "674", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "675", "colour": "orange", "code": "    return moment(a, 3, sample) / (moment(a, 2, sample) ** 1.5 or 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "676", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "677", "colour": "orange", "code": "skew = skewness\n", "error": "none", "author": "tom@organisms.be"}, {"index": "678", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "679", "colour": "orange", "code": "def kurtosis(iterable, sample=False):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "680", "colour": "orange", "code": "    \"\"\" Returns the degree of peakedness of the given list of values:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "681", "colour": "orange", "code": "        > 0.0 => sharper peak around mean(list) = more infrequent, extreme values,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "682", "colour": "orange", "code": "        < 0.0 => wider peak around mean(list),\n", "error": "none", "author": "tom@organisms.be"}, {"index": "683", "colour": "orange", "code": "        = 0.0 => normal distribution,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "684", "colour": "orange", "code": "        =  -3 => flat\n", "error": "none", "author": "tom@organisms.be"}, {"index": "685", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "686", "colour": "orange", "code": "    a = iterable if isinstance(iterable, list) else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "687", "colour": "orange", "code": "    return moment(a, 4, sample) / (moment(a, 2, sample) ** 2.0 or 1) - 3\n", "error": "none", "author": "tom@organisms.be"}, {"index": "688", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "689", "colour": "orange", "code": "#a = 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "690", "colour": "orange", "code": "#b = 1000\n", "error": "none", "author": "tom@organisms.be"}, {"index": "691", "colour": "orange", "code": "#U = [float(i-a)/(b-a) for i in range(a,b)] # uniform distribution\n", "error": "none", "author": "tom@organisms.be"}, {"index": "692", "colour": "orange", "code": "#print(abs(-1.2 - kurtosis(U)) < 0.0001)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "693", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "694", "colour": "orange", "code": "#--- QUANTILE --------------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "695", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "696", "colour": "blue", "code": "def quantile(iterable, p=0.5, sort=True, a=1, b=-1, c=0, d=1):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "697", "colour": "orange", "code": "    \"\"\" Returns the value from the sorted list at point p (0.0-1.0).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "698", "colour": "orange", "code": "        If p falls between two items in the list, the return value is interpolated.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "699", "colour": "orange", "code": "        For example, quantile(list, p=0.5) = median(list)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "700", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "701", "colour": "orange", "code": "    # Based on: Ernesto P. Adorio, http://adorio-research.org/wordpress/?p=125\n", "error": "none", "author": "tom@organisms.be"}, {"index": "702", "colour": "orange", "code": "    # Parameters a, b, c, d refer to the algorithm by Hyndman and Fan (1996):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "703", "colour": "orange", "code": "    # http://stat.ethz.ch/R-manual/R-patched/library/stats/html/quantile.html\n", "error": "none", "author": "tom@organisms.be"}, {"index": "704", "colour": "orange", "code": "    s = sorted(iterable) if sort is True else list(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "705", "colour": "orange", "code": "    n = len(s)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "706", "colour": "orange", "code": "    f, i = modf(a + (b+n) * p - 1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "707", "colour": "orange", "code": "    if n == 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "708", "colour": "orange", "code": "        raise ValueError(\"quantile() arg is an empty sequence\")\n", "error": "none", "author": "tom@organisms.be"}, {"index": "709", "colour": "orange", "code": "    if f == 0: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "710", "colour": "orange", "code": "        return float(s[int(i)])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "711", "colour": "orange", "code": "    if i < 0: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "712", "colour": "orange", "code": "        return float(s[int(i)])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "713", "colour": "orange", "code": "    if i >= n: \n", "error": "none", "author": "tom@organisms.be"}, {"index": "714", "colour": "orange", "code": "        return float(s[-1])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "715", "colour": "orange", "code": "    i = int(floor(i))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "716", "colour": "orange", "code": "    return s[i] + (s[i+1] - s[i]) * (c + d * f)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "717", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "718", "colour": "orange", "code": "#print(quantile(range(10), p=0.5) == median(range(10)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "719", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "720", "colour": "orange", "code": "def boxplot(iterable, **kwargs):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "721", "colour": "orange", "code": "    \"\"\" Returns a tuple (min(list), Q1, Q2, Q3, max(list)) for the given list of values.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "722", "colour": "orange", "code": "        Q1, Q2, Q3 are the quantiles at 0.25, 0.5, 0.75 respectively.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "723", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "724", "colour": "orange", "code": "    # http://en.wikipedia.org/wiki/Box_plot\n", "error": "none", "author": "tom@organisms.be"}, {"index": "725", "colour": "orange", "code": "    kwargs.pop(\"p\", None)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "726", "colour": "orange", "code": "    kwargs.pop(\"sort\", None)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "727", "colour": "orange", "code": "    s = sorted(iterable)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "728", "colour": "orange", "code": "    Q1 = quantile(s, p=0.25, sort=False, **kwargs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "729", "colour": "orange", "code": "    Q2 = quantile(s, p=0.50, sort=False, **kwargs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "730", "colour": "orange", "code": "    Q3 = quantile(s, p=0.75, sort=False, **kwargs)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "731", "colour": "orange", "code": "    return float(min(s)), Q1, Q2, Q3, float(max(s))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "732", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "733", "colour": "orange", "code": "#### STATISTICAL TESTS #############################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "734", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "735", "colour": "orange", "code": "#--- FISHER'S EXACT TEST ---------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "736", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "737", "colour": "green", "code": "def fisher_exact_test(a, b, c, d, **kwargs):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "738", "colour": "orange", "code": "    \"\"\" Fast implementation of Fisher's exact test (two-tailed).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "739", "colour": "orange", "code": "        Returns the significance p for the given 2 x 2 contingency table:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "740", "colour": "orange", "code": "        p < 0.05: significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "741", "colour": "orange", "code": "        p < 0.01: very significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "742", "colour": "orange", "code": "        The following test shows a very significant correlation between gender & dieting:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "743", "colour": "orange", "code": "        -----------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "744", "colour": "orange", "code": "        |             | men | women |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "745", "colour": "orange", "code": "        |     dieting |  1  |   9   |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "746", "colour": "orange", "code": "        | non-dieting | 11  |   3   |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "747", "colour": "orange", "code": "        -----------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "748", "colour": "orange", "code": "        fisher_exact_test(a=1, b=9, c=11, d=3) => 0.0028\n", "error": "none", "author": "tom@organisms.be"}, {"index": "749", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "750", "colour": "orange", "code": "    _cache = {}\n", "error": "none", "author": "tom@organisms.be"}, {"index": "751", "colour": "orange", "code": "    # Hypergeometric distribution.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "752", "colour": "orange", "code": "    # (a+b)!(c+d)!(a+c)!(b+d)! / a!b!c!d!n! for n=a+b+c+d\n", "error": "none", "author": "tom@organisms.be"}, {"index": "753", "colour": "orange", "code": "    def p(a, b, c, d):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "754", "colour": "orange", "code": "        return C(a + b, a) * C(c + d, c) / C(a + b + c + d, a + c)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "755", "colour": "orange", "code": "    # Binomial coefficient.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "756", "colour": "orange", "code": "    # n! / k!(n-k)! for 0 <= k <= n\n", "error": "none", "author": "tom@organisms.be"}, {"index": "757", "colour": "orange", "code": "    def C(n, k):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "758", "colour": "orange", "code": "        if len(_cache) > 10000:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "759", "colour": "orange", "code": "            _cache.clear()\n", "error": "none", "author": "tom@organisms.be"}, {"index": "760", "colour": "orange", "code": "        if k > n - k: # 2x speedup.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "761", "colour": "orange", "code": "            k = n - k\n", "error": "none", "author": "tom@organisms.be"}, {"index": "762", "colour": "orange", "code": "        if 0 <= k <= n and (n, k) not in _cache:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "763", "colour": "orange", "code": "            c = 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "764", "colour": "orange", "code": "            for i in xrange(1, int(k + 1)):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "765", "colour": "orange", "code": "                c *= n - k + i\n", "error": "none", "author": "tom@organisms.be"}, {"index": "766", "colour": "orange", "code": "                c /= i\n", "error": "none", "author": "tom@organisms.be"}, {"index": "767", "colour": "orange", "code": "            _cache[(n, k)] = c # 3x speedup.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "768", "colour": "orange", "code": "        return _cache.get((n, k), 0.0)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "769", "colour": "orange", "code": "    # Probability of the given data.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "770", "colour": "orange", "code": "    cutoff = p(a, b, c, d)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "771", "colour": "orange", "code": "    # Probabilities of \"more extreme\" data, in both directions (two-tailed).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "772", "colour": "orange", "code": "    # Based on: http://www.koders.com/java/fid868948AD5196B75C4C39FEA15A0D6EAF34920B55.aspx?s=252\n", "error": "none", "author": "tom@organisms.be"}, {"index": "773", "colour": "orange", "code": "    s = [cutoff] + \\\n", "error": "none", "author": "tom@organisms.be"}, {"index": "774", "colour": "orange", "code": "        [p(a+i, b-i, c-i, d+i) for i in xrange(1, min(int(b), int(c)) + 1)] + \\\n", "error": "none", "author": "tom@organisms.be"}, {"index": "775", "colour": "orange", "code": "        [p(a-i, b+i, c+i, d-i) for i in xrange(1, min(int(a), int(d)) + 1)]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "776", "colour": "orange", "code": "    return sum(v for v in s if v <= cutoff) or 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "777", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "778", "colour": "orange", "code": "fisher = fisher_test = fisher_exact_test\n", "error": "none", "author": "tom@organisms.be"}, {"index": "779", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "780", "colour": "orange", "code": "#--- PEARSON'S CHI-SQUARED TEST --------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "781", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "782", "colour": "orange", "code": "LOWER = \"lower\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "783", "colour": "orange", "code": "UPPER = \"upper\" \n", "error": "none", "author": "tom@organisms.be"}, {"index": "784", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "785", "colour": "orange", "code": "def _expected(observed):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "786", "colour": "orange", "code": "    \"\"\" Returns the table of (absolute) expected frequencies\n", "error": "none", "author": "tom@organisms.be"}, {"index": "787", "colour": "orange", "code": "        from the given table of observed frequencies.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "788", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "789", "colour": "orange", "code": "    o = observed\n", "error": "none", "author": "tom@organisms.be"}, {"index": "790", "colour": "orange", "code": "    if len(o) == 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "791", "colour": "orange", "code": "        return []\n", "error": "none", "author": "tom@organisms.be"}, {"index": "792", "colour": "orange", "code": "    if len(o) == 1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "793", "colour": "orange", "code": "        return [[sum(o[0]) / float(len(o[0]))] * len(o[0])]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "794", "colour": "orange", "code": "    n = [sum(o[i]) for i in xrange(len(o))]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "795", "colour": "orange", "code": "    m = [sum(o[i][j] for i in xrange(len(o))) for j in xrange(len(o[0]))]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "796", "colour": "orange", "code": "    s = float(sum(n))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "797", "colour": "orange", "code": "    # Each cell = row sum * column sum / total.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "798", "colour": "orange", "code": "    return [[n[i] * m[j] / s for j in xrange(len(o[i]))] for i in xrange(len(o))]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "799", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "800", "colour": "green", "code": "def pearson_chi_squared_test(observed=[], expected=[], df=None, tail=UPPER):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "801", "colour": "orange", "code": "    \"\"\" Returns (x2, p) for the n x m observed and expected data (containing absolute frequencies).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "802", "colour": "orange", "code": "        If expected is None, an equal distribution over all classes is assumed.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "803", "colour": "orange", "code": "        If df is None, it is (n-1) * (m-1).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "804", "colour": "orange", "code": "        p < 0.05: significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "805", "colour": "orange", "code": "        p < 0.01: very significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "806", "colour": "orange", "code": "        This means that if p < 5%, the data is unevenly distributed (e.g., biased).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "807", "colour": "orange", "code": "        The following test shows that the die is fair:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "808", "colour": "orange", "code": "        ---------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "809", "colour": "orange", "code": "        |       | 1  | 2  | 3  | 4  | 5  | 6  | \n", "error": "none", "author": "tom@organisms.be"}, {"index": "810", "colour": "orange", "code": "        | rolls | 22 | 21 | 22 | 27 | 22 | 36 |\n", "error": "none", "author": "tom@organisms.be"}, {"index": "811", "colour": "orange", "code": "        ---------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "812", "colour": "orange", "code": "        chi2([[22, 21, 22, 27, 22, 36]]) => (6.72, 0.24)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "813", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "814", "colour": "orange", "code": "    # The p-value (upper tail area) is obtained from the incomplete gamma integral:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "815", "colour": "orange", "code": "    # p(x2 | v) = gammai(v/2, x/2) with v degrees of freedom.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "816", "colour": "orange", "code": "    # See: Cephes, https://github.com/scipy/scipy/blob/master/scipy/special/cephes/chdtr.c\n", "error": "none", "author": "tom@organisms.be"}, {"index": "817", "colour": "orange", "code": "    o  = list(observed)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "818", "colour": "orange", "code": "    e  = list(expected) or _expected(o)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "819", "colour": "orange", "code": "    n  = len(o)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "820", "colour": "orange", "code": "    m  = len(o[0]) if o else 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "821", "colour": "orange", "code": "    df = df or (n-1) * (m-1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "822", "colour": "orange", "code": "    df = df or (m == 1 and n-1 or m-1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "823", "colour": "green", "code": "    x2 = 0.0\n", "error": "W", "author": "tom@organisms.be"}, {"index": "824", "colour": "orange", "code": "    for i in xrange(n):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "825", "colour": "orange", "code": "        for j in xrange(m):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "826", "colour": "orange", "code": "            if o[i][j] != 0 and e[i][j] != 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "827", "colour": "orange", "code": "                x2 += (o[i][j] - e[i][j]) ** 2.0 / e[i][j]  \n", "error": "none", "author": "tom@organisms.be"}, {"index": "828", "colour": "orange", "code": "    p = gammai(df * 0.5, x2 * 0.5, tail)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "829", "colour": "orange", "code": "    return (x2, p)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "830", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "831", "colour": "orange", "code": "X2 = x2 = chi2 = chi_square = chi_squared = pearson_chi_squared_test\n", "error": "none", "author": "tom@organisms.be"}, {"index": "832", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "833", "colour": "green", "code": "def chi2p(x2, df=1, tail=UPPER):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "834", "colour": "orange", "code": "    \"\"\" Returns p-value for given x2 and degrees of freedom.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "835", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "836", "colour": "orange", "code": "    return gammai(df * 0.5, x2 * 0.5, tail)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "837", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "838", "colour": "orange", "code": "#o, e = [[44, 56]], [[50, 50]]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "839", "colour": "orange", "code": "#assert round(chi_squared(o, e)[0], 4)  == 1.4400\n", "error": "none", "author": "tom@organisms.be"}, {"index": "840", "colour": "orange", "code": "#assert round(chi_squared(o, e)[1], 4)  == 0.2301\n", "error": "none", "author": "tom@organisms.be"}, {"index": "841", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "842", "colour": "orange", "code": "#--- PEARSON'S LOG LIKELIHOOD RATIO APPROXIMATION --------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "843", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "844", "colour": "green", "code": "def pearson_log_likelihood_ratio(observed=[], expected=[], df=None, tail=UPPER):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "845", "colour": "orange", "code": "    \"\"\" Returns (g, p) for the n x m observed and expected data (containing absolute frequencies).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "846", "colour": "orange", "code": "        If expected is None, an equal distribution over all classes is assumed.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "847", "colour": "orange", "code": "        If df is None, it is (n-1) * (m-1).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "848", "colour": "orange", "code": "        p < 0.05: significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "849", "colour": "orange", "code": "        p < 0.01: very significant\n", "error": "none", "author": "tom@organisms.be"}, {"index": "850", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "851", "colour": "orange", "code": "    o  = list(observed)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "852", "colour": "orange", "code": "    e  = list(expected) or _expected(o)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "853", "colour": "orange", "code": "    n  = len(o)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "854", "colour": "orange", "code": "    m  = len(o[0]) if o else 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "855", "colour": "orange", "code": "    df = df or (n-1) * (m-1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "856", "colour": "orange", "code": "    df = df or (m == 1 and n-1 or m-1)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "857", "colour": "orange", "code": "    g  = 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "858", "colour": "orange", "code": "    for i in xrange(n):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "859", "colour": "orange", "code": "        for j in xrange(m):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "860", "colour": "orange", "code": "            if o[i][j] != 0 and e[i][j] != 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "861", "colour": "orange", "code": "                g += o[i][j] * log(o[i][j] / e[i][j])\n", "error": "none", "author": "tom@organisms.be"}, {"index": "862", "colour": "orange", "code": "    g = g * 2\n", "error": "none", "author": "tom@organisms.be"}, {"index": "863", "colour": "orange", "code": "    p = gammai(df * 0.5, g * 0.5, tail)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "864", "colour": "orange", "code": "    return (g, p)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "865", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "866", "colour": "orange", "code": "llr = likelihood = pearson_log_likelihood_ratio\n", "error": "none", "author": "tom@organisms.be"}, {"index": "867", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "868", "colour": "orange", "code": "#--- KOLMOGOROV-SMIRNOV TWO SAMPLE TEST ------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "869", "colour": "orange", "code": "# Based on: https://github.com/scipy/scipy/blob/master/scipy/stats/stats.py\n", "error": "none", "author": "tom@organisms.be"}, {"index": "870", "colour": "orange", "code": "# Thanks to prof. F. De Smedt for additional information.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "871", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "872", "colour": "orange", "code": "NORMAL = \"normal\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "873", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "874", "colour": "orange", "code": "def kolmogorov_smirnov_two_sample_test(a1, a2=NORMAL, n=1000):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "875", "colour": "orange", "code": "    \"\"\" Returns the likelihood that two independent samples are drawn from the same distribution.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "876", "colour": "orange", "code": "        Returns a (d, p)-tuple with maximum distance d and two-tailed p-value.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "877", "colour": "orange", "code": "        By default, the second sample is the normal distribution.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "878", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "879", "colour": "orange", "code": "    if a2 == NORMAL:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "880", "colour": "orange", "code": "        a2 = norm(max(n, len(a1)), mean(a1), stdev(a1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "881", "colour": "orange", "code": "    n1 = float(len(a1))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "882", "colour": "orange", "code": "    n2 = float(len(a2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "883", "colour": "orange", "code": "    a1 = sorted(a1) # [1, 2, 5]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "884", "colour": "orange", "code": "    a2 = sorted(a2) # [3, 4, 6]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "885", "colour": "orange", "code": "    a3 = a1 + a2    # [1, 2, 5, 3, 4, 6]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "886", "colour": "orange", "code": "    # Find the indices in a1 so that, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "887", "colour": "orange", "code": "    # if the values in a3 were inserted before these indices,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "888", "colour": "orange", "code": "    # the order of a1 would be preserved:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "889", "colour": "orange", "code": "    cdf1 = [bisect_right(a1, v) for v in a3] # [1, 2, 3, 2, 2, 3]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "890", "colour": "orange", "code": "    cdf2 = [bisect_right(a2, v) for v in a3]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "891", "colour": "orange", "code": "    # Cumulative distributions.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "892", "colour": "orange", "code": "    cdf1 = [v / n1 for v in cdf1]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "893", "colour": "orange", "code": "    cdf2 = [v / n2 for v in cdf2]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "894", "colour": "orange", "code": "    # Compute maximum deviation between cumulative distributions.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "895", "colour": "orange", "code": "    d = max(abs(v1 - v2) for v1, v2 in zip(cdf1, cdf2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "896", "colour": "orange", "code": "    # Compute p-value.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "897", "colour": "orange", "code": "    e = sqrt(n1 * n2 / (n1 + n2))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "898", "colour": "orange", "code": "    p = kolmogorov((e + 0.12 + 0.11 / e) * d)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "899", "colour": "orange", "code": "    return d, p\n", "error": "none", "author": "tom@organisms.be"}, {"index": "900", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "901", "colour": "orange", "code": "ks2 = kolmogorov_smirnov_two_sample_test\n", "error": "none", "author": "tom@organisms.be"}, {"index": "902", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "903", "colour": "orange", "code": "#### SPECIAL FUNCTIONS #############################################################################\n", "error": "none", "author": "tom@organisms.be"}, {"index": "904", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "905", "colour": "orange", "code": "#--- GAMMA FUNCTION --------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "906", "colour": "orange", "code": "# Based on: http://www.johnkerl.org/python/sp_funcs_m.py.txt, Tom Loredo\n", "error": "none", "author": "tom@organisms.be"}, {"index": "907", "colour": "orange", "code": "# See also: http://www.mhtl.uwaterloo.ca/courses/me755/web_chap1.pdf\n", "error": "none", "author": "tom@organisms.be"}, {"index": "908", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "909", "colour": "orange", "code": "def gamma(x):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "910", "colour": "orange", "code": "    \"\"\" Returns the gamma function at x.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "911", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "912", "colour": "orange", "code": "    return exp(gammaln(x))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "913", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "914", "colour": "orange", "code": "def gammaln(x):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "915", "colour": "orange", "code": "    \"\"\" Returns the natural logarithm of the gamma function at x.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "916", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "917", "colour": "orange", "code": "    x = x - 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "918", "colour": "orange", "code": "    y = x + 5.5\n", "error": "none", "author": "tom@organisms.be"}, {"index": "919", "colour": "orange", "code": "    y = (x + 0.5) * log(y) - y\n", "error": "none", "author": "tom@organisms.be"}, {"index": "920", "colour": "orange", "code": "    n = 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "921", "colour": "orange", "code": "    for i in range(6):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "922", "colour": "orange", "code": "        x += 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "923", "colour": "orange", "code": "        n += (\n", "error": "none", "author": "tom@organisms.be"}, {"index": "924", "colour": "orange", "code": "          76.18009173, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "925", "colour": "orange", "code": "         -86.50532033, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "926", "colour": "orange", "code": "          24.01409822, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "927", "colour": "orange", "code": "          -1.231739516e0, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "928", "colour": "orange", "code": "           0.120858003e-2, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "929", "colour": "orange", "code": "          -0.536382e-5)[i] / x\n", "error": "none", "author": "tom@organisms.be"}, {"index": "930", "colour": "orange", "code": "    return y + log(2.50662827465 * n)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "931", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "932", "colour": "orange", "code": "lgamma = gammaln\n", "error": "none", "author": "tom@organisms.be"}, {"index": "933", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "934", "colour": "blue", "code": "def gammai(a, x, tail=UPPER):\n", "error": "R", "author": "tom@organisms.be"}, {"index": "935", "colour": "orange", "code": "    \"\"\" Returns the incomplete gamma function for LOWER or UPPER tail.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "936", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "937", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "938", "colour": "orange", "code": "    # Series approximation.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "939", "colour": "orange", "code": "    def _gs(a, x, epsilon=3.e-7, iterations=700):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "940", "colour": "orange", "code": "        ln = gammaln(a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "941", "colour": "orange", "code": "        s = 1.0 / a\n", "error": "none", "author": "tom@organisms.be"}, {"index": "942", "colour": "orange", "code": "        d = 1.0 / a\n", "error": "none", "author": "tom@organisms.be"}, {"index": "943", "colour": "orange", "code": "        for i in xrange(1, iterations):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "944", "colour": "orange", "code": "            d = d * x / (a + i)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "945", "colour": "orange", "code": "            s = s + d\n", "error": "none", "author": "tom@organisms.be"}, {"index": "946", "colour": "orange", "code": "            if abs(d) < abs(s) * epsilon:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "947", "colour": "orange", "code": "                return (s * exp(-x + a * log(x) - ln), ln)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "948", "colour": "orange", "code": "        raise StopIteration(abs(d), abs(s) * epsilon)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "949", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "950", "colour": "orange", "code": "    # Continued fraction approximation.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "951", "colour": "orange", "code": "    def _gf(a, x, epsilon=3.e-7, iterations=200):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "952", "colour": "orange", "code": "        ln = gammaln(a)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "953", "colour": "orange", "code": "        g0 = 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "954", "colour": "orange", "code": "        a0 = 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "955", "colour": "orange", "code": "        b0 = 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "956", "colour": "orange", "code": "        a1 = x\n", "error": "none", "author": "tom@organisms.be"}, {"index": "957", "colour": "orange", "code": "        b1 = 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "958", "colour": "orange", "code": "        f  = 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "959", "colour": "orange", "code": "        for i in xrange(1, iterations):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "960", "colour": "orange", "code": "            a0 = (a1 + a0 * (i - a)) * f\n", "error": "none", "author": "tom@organisms.be"}, {"index": "961", "colour": "orange", "code": "            b0 = (b1 + b0 * (i - a)) * f\n", "error": "none", "author": "tom@organisms.be"}, {"index": "962", "colour": "orange", "code": "            a1 = x * a0 + a1 * i * f\n", "error": "none", "author": "tom@organisms.be"}, {"index": "963", "colour": "orange", "code": "            b1 = x * b0 + b1 * i * f\n", "error": "none", "author": "tom@organisms.be"}, {"index": "964", "colour": "orange", "code": "            if a1 != 0.0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "965", "colour": "orange", "code": "                f = 1.0 / a1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "966", "colour": "orange", "code": "                g = b1 * f\n", "error": "none", "author": "tom@organisms.be"}, {"index": "967", "colour": "orange", "code": "                if abs((g - g0) / g) < epsilon:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "968", "colour": "orange", "code": "                    return (g * exp(-x + a * log(x) - ln), ln)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "969", "colour": "orange", "code": "                g0 = g\n", "error": "none", "author": "tom@organisms.be"}, {"index": "970", "colour": "orange", "code": "        raise StopIteration(abs((g-g0) / g))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "971", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "972", "colour": "orange", "code": "    if a <= 0.0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "973", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "974", "colour": "orange", "code": "    if x <= 0.0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "975", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "976", "colour": "orange", "code": "    if x < a + 1:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "977", "colour": "orange", "code": "        if tail == LOWER:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "978", "colour": "orange", "code": "            return _gs(a, x)[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "979", "colour": "orange", "code": "        return 1 - _gs(a, x)[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "980", "colour": "orange", "code": "    else:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "981", "colour": "orange", "code": "        if tail == UPPER:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "982", "colour": "orange", "code": "            return _gf(a, x)[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "983", "colour": "orange", "code": "        return 1 - _gf(a, x)[0]\n", "error": "none", "author": "tom@organisms.be"}, {"index": "984", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "985", "colour": "orange", "code": "#--- ERROR FUNCTION --------------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "986", "colour": "orange", "code": "# Based on: http://www.johnkerl.org/python/sp_funcs_m.py.txt, Tom Loredo\n", "error": "none", "author": "tom@organisms.be"}, {"index": "987", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "988", "colour": "orange", "code": "def erf(x):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "989", "colour": "orange", "code": "    \"\"\" Returns the error function at x.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "990", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "991", "colour": "orange", "code": "    return 1.0 - erfc(x)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "992", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "993", "colour": "orange", "code": "def erfc(x):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "994", "colour": "orange", "code": "    \"\"\" Returns the complementary error function at x.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "995", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "996", "colour": "orange", "code": "    z = abs(x)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "997", "colour": "orange", "code": "    t = 1.0 / (1 + 0.5 * z)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "998", "colour": "orange", "code": "    r = 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "999", "colour": "orange", "code": "    for y in (\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1000", "colour": "orange", "code": "      0.17087277, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1001", "colour": "orange", "code": "     -0.82215223, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1002", "colour": "orange", "code": "      1.48851587, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1003", "colour": "orange", "code": "     -1.13520398, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1004", "colour": "orange", "code": "      0.27886807, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1005", "colour": "orange", "code": "     -0.18628806, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1006", "colour": "orange", "code": "      0.09678418, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1007", "colour": "orange", "code": "      0.37409196, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1008", "colour": "orange", "code": "      1.00002368, \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1009", "colour": "orange", "code": "     -1.26551223):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1010", "colour": "orange", "code": "        r = y + t * r\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1011", "colour": "orange", "code": "    r = t * exp(-z ** 2 + r)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1012", "colour": "orange", "code": "    if x >= 0:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1013", "colour": "orange", "code": "        return r\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1014", "colour": "orange", "code": "    return 2.0 - r\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1015", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1016", "colour": "orange", "code": "#--- NORMAL DISTRIBUTION ---------------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1017", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1018", "colour": "green", "code": "def cdf(x, mean=0.0, stdev=1.0):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "1019", "colour": "orange", "code": "    \"\"\" Returns the cumulative distribution function at x.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1020", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1021", "colour": "orange", "code": "    return min(1.0, 0.5 * erfc((-x + mean) / (stdev * 2**0.5)))\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1022", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1023", "colour": "green", "code": "def pdf(x, mean=0.0, stdev=1.0):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "1024", "colour": "orange", "code": "    \"\"\" Returns the probability density function at x:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1025", "colour": "orange", "code": "        the likelihood of x in a distribution with given mean and standard deviation.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1026", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1027", "colour": "orange", "code": "    u = float(x - mean) / abs(stdev)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1028", "colour": "orange", "code": "    return (1 / (sqrt(2*pi) * abs(stdev))) * exp(-u*u / 2)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1029", "colour": "orange", "code": "    \n", "error": "none", "author": "tom@organisms.be"}, {"index": "1030", "colour": "orange", "code": "normpdf = pdf\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1031", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1032", "colour": "green", "code": "def norm(n, mean=0.0, stdev=1.0):\n", "error": "W", "author": "tom@organisms.be"}, {"index": "1033", "colour": "orange", "code": "    \"\"\" Returns a list of n random samples from the normal distribution.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1034", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1035", "colour": "green", "code": "    return [gauss(mean, stdev) for i in xrange(n)]\n", "error": "W", "author": "tom@organisms.be"}, {"index": "1036", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1037", "colour": "orange", "code": "#--- KOLMOGOROV DISTRIBUTION -----------------------------------------------------------------------\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1038", "colour": "orange", "code": "# Based on: http://www.math.ucla.edu/~tom/distributions/Kolmogorov.html, Thomas Ferguson\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1039", "colour": "orange", "code": "\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1040", "colour": "orange", "code": "def kolmogorov(x):\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1041", "colour": "orange", "code": "    \"\"\" Returns the approximation of Kolmogorov's distribution of the two-sample test.\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1042", "colour": "orange", "code": "        For a sample of size m and a sample of size n,\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1043", "colour": "orange", "code": "        it is the probability that the maximum deviation > x / sqrt(m+n).\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1044", "colour": "orange", "code": "    \"\"\"\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1045", "colour": "orange", "code": "    if x < 0.27:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1046", "colour": "orange", "code": "        return 1.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1047", "colour": "orange", "code": "    if x > 3.2:\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1048", "colour": "orange", "code": "        return 0.0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1049", "colour": "orange", "code": "    x = -2.0 * x * x\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1050", "colour": "orange", "code": "    k = 0\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1051", "colour": "orange", "code": "    for i in reversed(range(1, 27+1, 2)): # 27 25 23 ... 1\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1052", "colour": "orange", "code": "        k = (1 - k) * exp(x * i)\n", "error": "none", "author": "tom@organisms.be"}, {"index": "1053", "colour": "orange", "code": "    return 2.0 * k\n", "error": "none", "author": "tom@organisms.be"}]}